"use strict";(self.webpackChunktasky_supplier=self.webpackChunktasky_supplier||[]).push([[76],{8076:(H,v,d)=>{d.r(v),d.d(v,{CategListModule:()=>J});var g=d(7087),f=d(3759),p=d(3241),y=d(4344),t=d(2283),b=d(6806),w=d(3638),x=d(1359),k=d(8937),Z=d(3578),h=d(9347),C=d(8464);function T(l,u){if(1&l){const e=t.EpF();t.TgZ(0,"div",41)(1,"div",42)(2,"div",43),t._uU(3),t.qZA(),t.TgZ(4,"div",44),t._uU(5,"Agregar a filtro de b\xfasqueda: "),t.TgZ(6,"span",45),t._uU(7),t.qZA(),t._uU(8," - Tipo de campo: "),t.TgZ(9,"span",46),t._uU(10),t.qZA(),t._uU(11," - Tipo de selector: "),t.TgZ(12,"span",46),t._uU(13),t.qZA()(),t.TgZ(14,"mat-icon",36),t.NdJ("click",function(){const a=t.CHM(e).index,o=t.oxw().index,c=t.oxw(3).$implicit,n=t.oxw();return t.KtG(n.swapElementItem(c,o,a))}),t._uU(15,"swap_vert"),t.qZA(),t.TgZ(16,"mat-icon",36),t.NdJ("click",function(){const a=t.CHM(e).index,o=t.oxw().index,c=t.oxw(3).$implicit,n=t.oxw();return t.KtG(n.addEditElementItem(c,o,a))}),t._uU(17,"edit"),t.qZA(),t.TgZ(18,"mat-icon",47),t.NdJ("click",function(){const a=t.CHM(e).index,o=t.oxw().index,c=t.oxw(3).$implicit,n=t.oxw();return t.KtG(n.deleteCharactItem(c,o,a))}),t._uU(19,"delete"),t.qZA()()()}if(2&l){const e=u.$implicit;t.xp6(3),t.hij(" ",e.title,": "),t.xp6(4),t.Oqu(e.add2filter),t.xp6(3),t.Oqu(e.type),t.xp6(3),t.Oqu(e.selectType)}}function L(l,u){if(1&l){const e=t.EpF();t.TgZ(0,"div",31)(1,"div",32)(2,"div",33)(3,"div",34)(4,"div",35),t._uU(5),t.qZA(),t._uU(6," \xa0 "),t.TgZ(7,"mat-icon",36),t.NdJ("click",function(){const a=t.CHM(e).index,o=t.oxw(3).$implicit,c=t.oxw();return t.KtG(c.swapPropItem(o,a))}),t._uU(8,"swap_vert"),t.qZA(),t.TgZ(9,"mat-icon",37),t.NdJ("click",function(){const a=t.CHM(e).index,o=t.oxw(3).$implicit,c=t.oxw();return t.KtG(c.addEditCharactHeader(o,a))}),t._uU(10,"edit"),t.qZA(),t.TgZ(11,"mat-icon",23),t.NdJ("click",function(){const a=t.CHM(e).index,o=t.oxw(3).$implicit,c=t.oxw();return t.KtG(c.deleteHeader(o,a))}),t._uU(12,"delete"),t.qZA()(),t.TgZ(13,"div",38)(14,"div",39),t._uU(15,"Elementos de las propiedades"),t.qZA(),t.TgZ(16,"div")(17,"mat-icon",22),t.NdJ("click",function(){const a=t.CHM(e).index,o=t.oxw(3).$implicit,c=t.oxw();return t.KtG(c.addEditElementItem(o,a,-1))}),t._uU(18,"add"),t.qZA()()()(),t.YNc(19,T,20,4,"div",40),t.qZA()()}if(2&l){const e=u.$implicit;t.xp6(5),t.Oqu(e.header),t.xp6(14),t.Q6J("ngForOf",e.data)}}function A(l,u){if(1&l){const e=t.EpF();t.TgZ(0,"div")(1,"div",26),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.addEditCharactHeader(s,-1))}),t.TgZ(2,"div",27),t._uU(3,"Propiedades"),t.qZA(),t._uU(4," \xa0 "),t.TgZ(5,"mat-icon",28),t._uU(6,"add"),t.qZA()(),t.TgZ(7,"div",29),t.YNc(8,L,20,2,"div",30),t.qZA()()}if(2&l){const e=t.oxw(2).$implicit;t.xp6(8),t.Q6J("ngForOf",e.characterList)}}function U(l,u){if(1&l){const e=t.EpF();t.TgZ(0,"div",13)(1,"div",14)(2,"div",15),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(),a=s.$implicit,o=s.index,c=t.oxw();return t.KtG(c.addEditCategory(a,o))}),t._UZ(3,"img",16),t.qZA(),t.TgZ(4,"div",17)(5,"div",18)(6,"mat-icon",19),t._uU(7),t.qZA(),t.TgZ(8,"div",20),t._uU(9),t.qZA()(),t.TgZ(10,"div",21)(11,"mat-icon",22),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(),a=s.$implicit,o=s.index,c=t.oxw();return t.KtG(c.addEditCategory(a,o))}),t._uU(12,"edit"),t.qZA(),t.TgZ(13,"mat-icon",22),t.NdJ("click",function(){t.CHM(e);const s=t.oxw().index,a=t.oxw();return t.KtG(a.switchSubView(s))}),t._uU(14,"expand_more"),t.qZA(),t._uU(15," \xa0 "),t.TgZ(16,"mat-icon",23),t.NdJ("click",function(){t.CHM(e);const s=t.oxw().index,a=t.oxw();return t.KtG(a.deleteCategory(s))}),t._uU(17,"delete"),t.qZA(),t.TgZ(18,"div",24),t.NdJ("click",function(){t.CHM(e);const s=t.oxw().$implicit,a=t.oxw();return t.KtG(a.categLevel(s,1))}),t.TgZ(19,"span"),t._uU(20,"Sub categor\xeda"),t.qZA(),t.TgZ(21,"mat-icon"),t._uU(22,"chevron_right"),t.qZA()()()()(),t.YNc(23,A,9,1,"div",25),t.qZA()}if(2&l){const e=t.oxw(),i=e.$implicit,s=e.index,a=t.oxw();t.xp6(3),t.Q6J("src",a.getCategImage(i),t.LSH),t.xp6(4),t.Oqu(a.getCategVisible(i.visible)),t.xp6(2),t.Oqu(i.name),t.xp6(14),t.Q6J("ngIf",a.getSubView(s))}}function q(l,u){if(1&l&&(t.TgZ(0,"div"),t.YNc(1,U,24,4,"div",12),t.qZA()),2&l){const e=u.$implicit,i=t.oxw();t.xp6(1),t.Q6J("ngIf",i.getCateg2Show(e))}}const E=[{path:"",component:(()=>{class l{constructor(e,i,s,a){this.dtb=e,this.dg=i,this.snkBar=s,this.sanitizer=a,this.categ_list=[],this.subView=-1,this.categShow=[{_id:"root",title:"Raiz"}],this.categorySchema={controls:[{name:"_id",label:"C\xf3digo:",type:"text",style:"w-full",disabled:!0,validators:{required:!0}},{name:"name",label:"Nombre de la categor\xeda:",type:"text",style:"w-full",validators:{required:!0}},{name:"description",label:"Descripci\xf3n:",type:"textarea",style:"w-full",totalRows:2,validators:{}},{name:"visible",label:"Visible",type:"checkbox",validators:{}},{name:"indexCategory",label:"Viene de...",type:"multiselect",style:"w-full",selectOptions:[],validators:{}}]},this.characteristic={controls:[{name:"header",label:"T\xedtulo:",type:"text",style:"w-full",validators:{required:!0}},{name:"duplicable",label:"Duplicable",type:"checkbox",validators:{}}]},this.charactItem={controls:[{name:"id",label:"C\xf3digo:",type:"text",disabled:!0,validators:{}},{name:"title",label:"T\xedtulo del elemento:",type:"text",style:"w-full",validators:{required:!0}},{name:"add2filter",label:"Agregar a los filtros de b\xfasqueda",type:"checkbox",validators:{required:!0}},{name:"type",label:"Tipo de campo:",type:"select",selectOptions:[{key:"chip",value:"Chips"},{key:"prod_id",value:"C\xf3digo del producto"},{key:"prod_name",value:"Nombre del producto"},{key:"prod_long",value:"Descripci\xf3n del producto"},{key:"stock",value:"Existencia"},{key:"tax_p",value:"Impuesto %"},{key:"price",value:"Precio"},{key:"number",value:"N\xfamero"},{key:"text",value:"Texto"},{key:"textarea",value:"\xc1rea de texto"},{key:"checkbox",value:"si/no"},{key:"picture",value:"Foto/Imagen - v\xednculo"},{key:"link",value:"V\xednculo"}],style:"w-72",validators:{required:!0}},{name:"selectType",label:"Tipo de selector:",type:"select",selectOptions:[{key:"none",value:"Ninguno"},{key:"select",value:"Lista de selecci\xf3n"},{key:"select-images",value:"Lista de selecci\xf3n (v\xednculos)"},{key:"multiselect",value:"Lista de selecci\xf3n m\xfatiples"}],style:"w-72",validators:{required:!0}},{name:"selectlist",label:"Listado:",type:"select",sideBtn:"expand_more",selectOptions:[],disabled:!0,style:"w-full",validators:{}},{name:"source",label:"Fuente de los datos (http)",type:"text",style:"w-full",sideBtn:"http",validators:{}}]}}ngOnInit(){var e=this;return(0,p.Z)(function*(){e.getCategories()})()}getCategories(){var e=this;return(0,p.Z)(function*(){e.categ_list=(yield e.dtb.getAllCategAsync())||[],e.categShow=[{_id:"root",title:"Raiz"}],e.categ_list.sort((i,s)=>i.name.toLowerCase()<s.name.toLowerCase()?-1:1)})()}getClicked(e){var i=this;return(0,p.Z)(function*(){switch(e.index){case 1:case 3:break;case 2:i.addEditCategory(null,-1);break;case 4:yield i.getCategories()}})()}getCateg2Show(e){return!!(1===this.categShow.length&&0===e.indexCategory.length||e.indexCategory?.includes(this.categShow[this.categShow.length-1]._id))}categLevel(e,i){var s=this;return(0,p.Z)(function*(){if(-1===i&&s.categShow.length>1)s.categShow.splice(s.categShow.length-1,1);else{if(null===e)return yield s.getCategories();s.categShow.push({_id:e._id,title:e.name})}})()}getCategVisible(e){return e?"visibility":"visibility_off"}addEditCategory(e,i=-1){let s=-1===i;s&&(e={_id:this.dtb.nextConsecutive("C",3,!0,this.categ_list,"_id"),name:"",characterList:[],visible:!0,indexCategory:[]},this.categShow.length>1&&e.indexCategory?.push(this.categShow[this.categShow.length-1]._id));const a=[];if(this.categ_list.forEach(c=>{e._id!==c._id&&a.push({key:c._id,value:c.name})}),a.length>0&&this.categorySchema.controls){const c=this.categorySchema.controls.find(n=>"indexCategory"===n.name);c&&(c.selectOptions=a)}let o={schema:this.categorySchema,value:e,title:"Categor\xeda",showImage:!0,image:e.picture,imgwidth:400,imgheight:400,dgheigth:715};this.dg.aDefault(o).subscribe(c=>{c&&(delete c._propName_,delete c._valid_,this.dg.updatePropResult(e,c),o.image&&e&&(e.picture=o.image),s?this.categ_list.push(e):this.categ_list[i]=e,this.dtb.setCategory(e,s))})}deleteCategory(e){this.snkBar.open("Eliminar "+this.categ_list[e].name,"Ok",{duration:7e3}).onAction().subscribe(i=>{this.dtb.deleteCategory(this.categ_list[e]._id),this.categ_list.splice(e,1)})}addEditCharactHeader(e,i){let s=!1,a=e.characterList[i];if(-1===i){const c=this.dtb.getSerialKey(2,4);a={pos:0,cat_id:e._id,id:c,header:"",duplicable:!1,data:[]},s=!0}this.dg.aDefault({schema:this.characteristic,value:a,title:"T\xedtulo de la caracter\xedstica",dgheigth:265}).subscribe(c=>{if(c){if(delete c._propName_,delete c._valid_,this.dg.updatePropResult(a,c),s){let n=0;e.characterList.forEach(r=>{r.pos=n,n++}),a.pos=n,e.characterList.push(a)}else e.characterList[i]=a;this.dtb.setCategory(e,!1)}})}deleteHeader(e,i){const s=e.characterList[i];s&&this.snkBar.open("Eliminar "+s.header,"Ok",{duration:7e3}).onAction().subscribe(a=>{e.characterList.splice(i,1),this.dtb.setCategory(e,!1)})}swapPropItem(e,i){if(i>0){const s=e.characterList[i].pos;i--;const a=e.characterList[i].pos;e.characterList[i].pos=s,i++,e.characterList[i].pos=a,e.characterList.sort((o,c)=>o.pos-c.pos),this.dtb.setCategory(e,!1)}}addEditElementItem(e,i,s){let a=!0,c={pos:0,id:this.dtb.getSerialKey(2,4),title:"",type:"",selectType:"",add2filter:!1,selectlist:[]};if(s>=0&&e.characterList[i].data[s]&&(c=e.characterList[i].data[s],a=!1),c.selectlist&&c.selectlist.length>0){const r=this.charactItem.controls?.find(m=>"selectlist"===m.name);r&&(r.selectOptions=[],c.selectlist.forEach(m=>r.selectOptions?.push({key:m.key,value:m.value})))}this.dg.aDefault({schema:this.charactItem,value:c,title:"Propiedades de: "+e.characterList[i].header,dgwidth:600,dgheigth:660,function:[{name:"selectable",self:this,btn_source:!0,function:this.optionEditable},{name:"selectlist",self:this,btn_source:!0,function:this.selectlist}]}).subscribe(r=>{if(r){delete r._propName_,delete r._valid_,delete r.selectlist;const m=this.charactItem.controls?.find(_=>"selectlist"===_.name);if(m&&(c.selectlist=[],m.selectOptions?.forEach(_=>{c.selectlist?.push({id:`${c.id}_${_.key}`,key:_.key,value:_.value})})),this.dg.updatePropResult(c,r),a){let _=0;e.characterList[i].data.forEach(F=>{F.pos=_,_++}),c.pos=_,e.characterList[i].data.push(c)}else e.characterList[i].data[s]=c;this.dtb.setCategory(e,!1)}})}swapElementItem(e,i,s){if(s>0){const a=e.characterList[i].data[s].pos;s--;const o=e.characterList[i].data[s].pos;e.characterList[i].data[s].pos=a,s++,e.characterList[i].data[s].pos=o,e.characterList[i].data.sort((c,n)=>c.pos-n.pos),this.dtb.setCategory(e,!1)}}optionEditable(e,i,s){if(e.CharactItem.controls){const a=e.CharactItem.controls.findIndex(o=>"selectlist"===o.name);if(a&&a>=0)return e.CharactItem.controls[a].disabled=!i.selectable,i.selectable||(i.selectlist=""),{schema:e.CharactItem,value:i}}return""}selectlist(e,i,s){return(0,p.Z)(function*(){let a=[],o=s.controls?.find(r=>"selectlist"===r.name);o&&o.selectOptions?.forEach(r=>{a.push({key:r.key,value:r.value})});let c={value:a,title:"Lista de selecci\xf3n",dgwidth:500,dgheigth:700};const n=yield(0,y.z)(e.dg.aKeyValueEditor(c));return o=s.controls?.find(r=>"selectlist"===r.name),o&&(o.selectOptions=n),{schema:s}})()}deleteCharactItem(e,i,s){const a=e.characterList[i].data[s];a&&this.snkBar.open("Eliminar "+a.title,"Ok",{duration:7e3}).onAction().subscribe(o=>{e.characterList[i].data.splice(s,1),this.dtb.setCategory(e,!1)})}switchSubView(e){this.subView=this.subView===e?-1:e}getSubView(e){return this.subView===e}getCategImage(e){return e.picture?this.sanitizer.bypassSecurityTrustUrl(e.picture):""}fileChangeEvent(e,i=null){}static#t=this.\u0275fac=function(i){return new(i||l)(t.Y36(b.k),t.Y36(w.x),t.Y36(x.ux),t.Y36(k.H7))};static#e=this.\u0275cmp=t.Xpm({type:l,selectors:[["app-categ-list"]],decls:26,vars:5,consts:[[1,"flex","flex-col","max-h-screen"],[3,"buttons","nav_menu","onClicked"],["id","spanTrigger",3,"matMenuTriggerFor"],["editControlTrigger","matMenuTrigger"],[1,"flex-1","px-1","pt-1","bg-gray-100","overflow-auto"],[1,"flex","font-medium","mb-2","text-gray-400","hover:text-black",3,"click"],[4,"ngFor","ngForOf"],["products","matMenu"],[1,"font-medium"],["color","primary"],["color","primary",1,"mt-1"],["mat-menu-item",""],["class","p-1 flex flex-col bg-white border border-gray-500 mb-2",4,"ngIf"],[1,"p-1","flex","flex-col","bg-white","border","border-gray-500","mb-2"],[1,"flex","justify-start"],[1,"w-30",3,"click"],[1,"h-16","w-16","border","border-gray-400","py-1","px-1","rounded-full","shadow-sm",3,"src"],[1,"grow","ml-2","flex","flex-col"],[1,"flex","justify-start","font-medium"],[1,"text-gray-800"],[1,"ml-2"],[1,"mt-1","flex","justify-end","text-sky-200","bg-gray-100"],[1,"hover:text-sky-500",3,"click"],[1,"hover:text-red-500",3,"click"],[1,"ml-12","flex","text-gray-400","font-medium","hover:text-black",3,"click"],[4,"ngIf"],[1,"mt-2","flex","px-1","text-sm","bg-gray-100",3,"click"],[1,"mt-1","font-medium","text-gray-400","hover:text-black"],[1,"w-20","text-sky-200","hover:text-sky-500"],[1,"flex","flex-col","mx-2","mt-1","text-sm"],["class","mt-2",4,"ngFor","ngForOf"],[1,"mt-2"],[1,"border","border-gray-300"],[1,"flex","flex-row","align-middle","bg-gray-100"],[1,"grow","flex","flex-row","items-center","justify-center","text-sky-200"],[1,"text-center","font-medium","text-black"],[1,"text-sky-200","hover:text-sky-500",3,"click"],[1,"w-20","ml-1","hover:text-sky-500",3,"click"],[1,"w-40","flex","flex-row","items-end","justify-end","align-middle","font-medium","text-sm","text-sky-200"],[1,"text-gray-400","hover:text-black"],["class","flex flex-col",4,"ngFor","ngForOf"],[1,"flex","flex-col"],[1,"pt-2","flex","justify-items-start","align-middle","bg-white"],[1,"px-1","font-medium","text-sm"],[1,"grow","px-1","text-xs"],[1,"text-gray-400"],[1,"text-gray-500"],[1,"text-sky-200","hover:text-red-500",3,"click"]],template:function(i,s){if(1&i&&(t.TgZ(0,"div",0)(1,"app-header",1),t.NdJ("onClicked",function(o){return s.getClicked(o)}),t.qZA(),t._UZ(2,"span",2,3),t.TgZ(4,"div",4)(5,"div",5),t.NdJ("click",function(){return s.categLevel(null,-1)}),t.TgZ(6,"mat-icon"),t._uU(7,"chevron_left"),t.qZA(),t.TgZ(8,"div"),t._uU(9),t.qZA()(),t.YNc(10,q,2,1,"div",6),t.qZA(),t.TgZ(11,"mat-menu",null,7)(13,"div",8)(14,"mat-icon",9),t._uU(15,"cloud_upload"),t.qZA(),t._uU(16," Base remota "),t.qZA(),t._UZ(17,"hr"),t.TgZ(18,"div",8)(19,"mat-icon",10),t._uU(20,"edit"),t.qZA(),t._uU(21," Base local "),t.qZA(),t.TgZ(22,"button",11),t._uU(23," Data base hacia Excel "),t.qZA(),t.TgZ(24,"button",11),t._uU(25," Lista de im\xe1genes en la base "),t.qZA()()()),2&i){const a=t.MAs(12);t.xp6(1),t.Q6J("buttons","111111")("nav_menu",!1),t.xp6(1),t.Q6J("matMenuTriggerFor",a),t.xp6(7),t.Oqu(s.categShow[s.categShow.length-1].title),t.xp6(1),t.Q6J("ngForOf",s.categ_list)}},dependencies:[g.sg,g.O5,Z.G,h.VK,h.OP,h.p6,C.Hw]})}return l})()}];let S=(()=>{class l{static#t=this.\u0275fac=function(i){return new(i||l)};static#e=this.\u0275mod=t.oAB({type:l});static#i=this.\u0275inj=t.cJS({imports:[f.Bz.forChild(E),f.Bz]})}return l})();var O=d(769),N=d(7572);let J=(()=>{class l{static#t=this.\u0275fac=function(i){return new(i||l)};static#e=this.\u0275mod=t.oAB({type:l});static#i=this.\u0275inj=t.cJS({imports:[g.ez,S,O.O,h.Tx,C.Ps,x.ZX,N.N]})}return l})()}}]);