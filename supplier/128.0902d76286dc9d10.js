"use strict";(self.webpackChunktasky_supplier=self.webpackChunktasky_supplier||[]).push([[128],{3128:(E,u,a)=>{a.r(u),a.d(u,{PollResultDialogComponent:()=>y});var c=a(765),t=a(6339),g=a(7214),p=a(6789),m=a(3016),d=a(4070),_=a(506),v=a(1173),h=a(4370),f=a(8137);function Z(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"div",19)(2,"div",20),t._uU(3,"Enviar a..."),t.qZA(),t.TgZ(4,"div",21)(5,"div",4)(6,"mat-icon",5),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onDone(!0))}),t._uU(7,"send"),t.qZA()()()(),t.TgZ(8,"div",22)(9,"textarea",23),t.NdJ("ngModelChange",function(i){t.CHM(e);const n=t.oxw();return t.KtG(n.emaildata=i)}),t.qZA()()()}if(2&o){const e=t.oxw();t.xp6(9),t.Q6J("ngModel",e.emaildata)}}function x(o,s){1&o&&(t.TgZ(0,"div",9),t._uU(1," Conversaci\xf3n"),t.qZA())}function T(o,s){if(1&o&&(t.TgZ(0,"div")(1,"div",24)(2,"div")(3,"strong"),t._uU(4),t.qZA(),t._uU(5),t.qZA(),t.TgZ(6,"div",25),t._uU(7),t.ALo(8,"date"),t.qZA()()()),2&o){const e=s.$implicit,l=t.oxw();t.xp6(4),t.hij("",l.getWho(e),":"),t.xp6(1),t.hij("\xa0",e.msg,""),t.xp6(2),t.Oqu(t.lcZ(8,3,e.date))}}function b(o,s){if(1&o&&(t.TgZ(0,"div"),t._UZ(1,"img",30),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("src",e.value,t.LSH)("alt",e.name)}}function C(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",31),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,n=t.oxw();return t.KtG(n.gotolinkByKevalue(i))}),t._uU(1),t.qZA()}if(2&o){const e=t.oxw().$implicit,l=t.oxw();t.Q6J("ngClass",l.getLink(e)),t.xp6(1),t.hij(" ",l.getValue(e),"")}}function A(o,s){if(1&o&&(t.TgZ(0,"div")(1,"div",26)(2,"div",27),t._uU(3),t.qZA(),t.YNc(4,b,2,2,"div",7),t.YNc(5,C,2,2,"div",28),t._UZ(6,"div",29),t.qZA()()),2&o){const e=s.$implicit,l=t.oxw();t.xp6(1),t.Q6J("ngClass",l.getStytileFromEvidence(e.evidence)),t.xp6(2),t.Oqu(e.name),t.xp6(1),t.Q6J("ngIf","picture"===e.type),t.xp6(1),t.Q6J("ngIf","picture"!==e.type)}}function U(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",5),t.NdJ("click",function(){const n=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.getFile(n))}),t.TgZ(1,"div",32),t._uU(2),t.qZA()()}if(2&o){const e=s.$implicit,l=t.oxw();t.xp6(2),t.Oqu(l.getFileName(e))}}let y=(()=>{class o{constructor(e,l,i,n,r){this.dialogRef=e,this.data=l,this.http=i,this.sharedvar=n,this.dtb=r,this.pollValues=[],this.docCss="",this.emaildata="",this.viewmail=!1,e.disableClose=!1,this.pollresult=l.value,this.pollaValuesFromObject(this.pollresult.values,this.pollresult.values_type)}pollaValuesFromObject(e,l){if(!e||!l)return;this.http.getCssData().subscribe(r=>{this.docCss=r}),this.pollValues=[];Object.keys(e).forEach(r=>{this.pollValues.push({name:l[r].label,value:e[r],type:l[r].type,evidence:l[r].evidence})})}getWho(e){return"W"===e.type?"CONTROL":"TASKER"}getLink(e){return"geolocation"===e.type||"picture"===e.type?"underline text-sky-500":""}gotolinkByKevalue(e){return"picture"===e.type?window.open(e.value,"_blank"):"geolocation"===e.type?window.open(this.sharedvar.getLink2geo(e.value),"_blank"):""}gotolink(e){window.open(this.sharedvar.getLink2geo(e),"_blank")}getFileName(e){return e.split("_2D_").pop()}getFile(e){window.open(e,"_blank")}getValue(e){if(!e.type)return`lat: ${e.lat}, lng: ${e.lng}`;switch(e.type){case"geolocation":return`lat: ${e.lat}, lng: ${e.lng}`;case"date":return this.sharedvar.formatNumber2Date(e.value,"/");case"datetime-local":return this.sharedvar.formatNumber2DateTime(e.value,"/")}return e.value}onDone(e){if(e){const l=document.getElementById("printarea")?.innerHTML;let i="";l&&(i=`\n      <!DOCTYPE html><html><head><style>\n      ${this.docCss}\n      </style></head></style></head><body>\n      ${l}\n      </body></html>`),this.emaildata.split("\n").join(";"),this.dtb.notifMail(this.pollresult,this.emaildata,i,"end")}else this.emaildata="";this.dialogRef.close()}onPrint(){const e=document.getElementById("printarea")?.innerHTML;if(e){let l=window.open("","","height=500, width=500");l&&(l.document.write(`<html>\n        ${this.docCss}\n        <body>`),l.document.write(e),l.document.write("</body></html>"),l.document.close(),setTimeout(()=>{l?.print()},500))}}onMail(){this.viewmail=!this.viewmail}valueNameStyle(){}getStytileFromEvidence(e){return e?"ml-2 bg-blue-50":"bg-gray-100"}static#t=this.\u0275fac=function(l){return new(l||o)(t.Y36(c.so),t.Y36(c.WI),t.Y36(g.O),t.Y36(p.D),t.Y36(m.k))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-poll-result-dialog"]],decls:73,vars:20,consts:[[1,"flex","flex-col","h-full"],[1,"flex","h-16","p-3","text-2xl","bg-violet-600","text-white","font-medium"],[1,"flex-1"],[1,"w-10","h-10","border","border-white","rounded-md"],[1,"px-2","pt-1"],[3,"click"],[1,"w-10","border","border-white","rounded-md"],[4,"ngIf"],["id","printarea",1,"flex-1","px-3","overflow-auto"],[1,"text-2xl","px-1","text-black","bg-gray-200","border-b","border-gray-300"],[1,"pl-2"],["class","text-2xl px-1 text-black bg-gray-200 border-b border-gray-300",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"h-5"],[1,"text-2xl","px-1","pt-1","text-black","bg-gray-200","border-b","border-gray-300"],[3,"click",4,"ngFor","ngForOf"],[1,"underline","text-sky-500",3,"click"],[1,"h-14","flex","p-3","justify-end","border-t","border-violet-500"],["mat-stroked-button","","color","primary","cdkFocusInitia","",3,"click"],[1,"flex","text-2xl","px-1","text-black","bg-gray-200","border-b","border-gray-300"],[1,"grow"],[1,"m-1","w-10","font-medium","bg-violet-600","text-white","rounded-md","shadow-sm"],[1,"p-2"],["matInput","","rows","5",1,"w-full","border","border-gray-400",3,"ngModel","ngModelChange"],[1,"flex","flex-row","h-6","pt-1","text-xs","w-full","border-b","border-gray-200"],[1,"grow","text-xs","text-sky-700","text-right"],[3,"ngClass"],[1,"h-6","p-1","font-medium","border-b","border-gray-200","border-dashed"],["class","p-1 font-thin bg-white",3,"ngClass","click",4,"ngIf"],[1,"h-2"],[1,"h-56","object-fill",3,"src","alt"],[1,"p-1","font-thin","bg-white",3,"ngClass","click"],[1,"underline","text-sky-500"]],template:function(l,i){1&l&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3),t.qZA(),t.TgZ(4,"div",3)(5,"div",4)(6,"mat-icon",5),t.NdJ("click",function(){return i.onPrint()}),t._uU(7,"print"),t.qZA()()(),t._uU(8," \xa0 "),t.TgZ(9,"div",6)(10,"div",4)(11,"mat-icon",5),t.NdJ("click",function(){return i.onMail()}),t._uU(12,"mail"),t.qZA()()()(),t.YNc(13,Z,10,1,"div",7),t.TgZ(14,"div",8)(15,"div",9),t._uU(16,"Tasker"),t.qZA(),t.TgZ(17,"div",10)(18,"div")(19,"strong"),t._uU(20,"Nombre:"),t.qZA(),t._uU(21),t.qZA(),t.TgZ(22,"div")(23,"strong"),t._uU(24,"Identificaci\xf3n:"),t.qZA(),t._uU(25),t.qZA(),t.TgZ(26,"div")(27,"strong"),t._uU(28,"Platform:"),t.qZA(),t._uU(29),t.qZA(),t.TgZ(30,"div")(31,"strong"),t._uU(32,"Calificaci\xf3n:"),t.qZA(),t._uU(33),t.qZA()(),t.YNc(34,x,2,0,"div",11),t.TgZ(35,"div",10),t.YNc(36,T,9,5,"div",12),t.qZA(),t._UZ(37,"div",13),t.TgZ(38,"div",9),t._uU(39,"Resultado encuesta"),t.qZA(),t.YNc(40,A,7,4,"div",12),t._UZ(41,"div",13),t.TgZ(42,"div",14),t._uU(43,"Archivos Adjuntos"),t.qZA(),t.YNc(44,U,3,1,"div",15),t._UZ(45,"div",13),t.TgZ(46,"div",9),t._uU(47,"Informaci\xf3n Encuesta"),t.qZA(),t.TgZ(48,"div",10)(49,"div")(50,"strong"),t._uU(51,"Hora de inicio:"),t.qZA(),t._uU(52),t.ALo(53,"date"),t.qZA(),t.TgZ(54,"div")(55,"strong"),t._uU(56,"Ubicaci\xf3n inicial"),t.qZA()(),t.TgZ(57,"div",16),t.NdJ("click",function(){return i.gotolink(i.pollresult.geoLocStart||"")}),t._uU(58),t.qZA(),t.TgZ(59,"div")(60,"strong"),t._uU(61,"Hora de Finalizaci\xf3n:"),t.qZA(),t._uU(62),t.ALo(63,"date"),t.qZA(),t.TgZ(64,"div")(65,"strong"),t._uU(66,"Ubicaci\xf3n Final"),t.qZA()(),t.TgZ(67,"div",16),t.NdJ("click",function(){return i.gotolink(i.pollresult.geoLocEnd||"")}),t._uU(68),t.qZA()()(),t.TgZ(69,"div",17)(70,"button",18),t.NdJ("click",function(){return i.onDone(!1)}),t.TgZ(71,"mat-icon"),t._uU(72,"done"),t.qZA()()()()),2&l&&(t.xp6(3),t.hij(" ",i.data.title," "),t.xp6(10),t.Q6J("ngIf",i.viewmail),t.xp6(8),t.hij(" ",i.pollresult.staff_name,""),t.xp6(4),t.hij(" ",i.pollresult.staffId,""),t.xp6(4),t.hij(" ",i.pollresult.platform,""),t.xp6(4),t.hij(" ",i.pollresult.staff_star,""),t.xp6(1),t.Q6J("ngIf",i.pollresult.chats.length>0),t.xp6(2),t.Q6J("ngForOf",i.pollresult.chats),t.xp6(4),t.Q6J("ngForOf",i.pollValues),t.xp6(4),t.Q6J("ngForOf",i.pollresult.attachfiles),t.xp6(8),t.Oqu(t.xi3(53,14,i.pollresult.date_ini,"dd/MM/yy a hh:mm")),t.xp6(6),t.hij(" Geo localizaci\xf3n inicial: ",i.getValue(i.pollresult.geoLocStart),""),t.xp6(4),t.Oqu(t.xi3(63,17,i.pollresult.date_end,"dd/MM/yy a hh:mm")),t.xp6(6),t.hij(" Geo localizaci\xf3n inicial: ",i.getValue(i.pollresult.geoLocEnd),""))},dependencies:[d.mk,d.sg,d.O5,_.Fj,_.JJ,_.On,v.Nt,h.lW,f.Hw,d.uU]})}return o})()}}]);