"use strict";(self.webpackChunktasky_supplier=self.webpackChunktasky_supplier||[]).push([[634],{9634:(P,y,r)=>{r.r(y),r.d(y,{ActivityReportModule:()=>$});var p=r(7087),u=r(3759),f=r(3241),t=r(2283),g=r(4758),b=r(6806),Z=r(3638),C=r(1682),F=r(3620),O=r(3578),h=r(9347),T=r(8464),v=r(6410);function k(a,c){if(1&a&&(t.TgZ(0,"th"),t._uU(1),t.qZA()),2&a){const e=c.$implicit;t.xp6(1),t.Oqu(e)}}function J(a,c){if(1&a&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&a){const e=c.$implicit,i=t.oxw().$implicit,n=t.oxw();t.xp6(1),t.Oqu(n.getCols(e,i))}}function w(a,c){if(1&a&&(t.TgZ(0,"tr"),t.YNc(1,J,2,1,"td",2),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.headerTitle)}}let x=(()=>{class a{constructor(e){this.sharedvar=e,this.data=[],this.headerTitle=[]}ngOnChanges(e){this.buildTable()}buildTable(){this.headerTitle=[];for(let e of this.header.keys())this.headerTitle.push(e)}getCols(e,i){switch(this.header.get(e)){case"datetime-local":return this.sharedvar.formatNumber2DateTime(i[e],"/");case"date":return this.sharedvar.formatNumber2Date(i[e],"/");case"geolocation":return`lng: ${i[e].lng}, lat: ${i[e].lat}`;case"array":return i[e]?i[e].toString():""}return i[e]}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(g.D))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-table"]],inputs:{data:"data",header:"header"},features:[t.TTD],decls:6,vars:2,consts:[[1,"block","h-72","w-96","table-auto","border-separate"],[1,"px-6","py-2","text-sm","border-b","border-gray-500","text-gray-500","sticky","top-0","bg-white"],[4,"ngFor","ngForOf"],[1,"text-xs"]],template:function(i,n){1&i&&(t.TgZ(0,"table",0)(1,"thead",1)(2,"tr"),t.YNc(3,k,2,1,"th",2),t.qZA()(),t.TgZ(4,"tbody",3),t.YNc(5,w,2,1,"tr",2),t.qZA()()),2&i&&(t.xp6(3),t.Q6J("ngForOf",n.headerTitle),t.xp6(2),t.Q6J("ngForOf",n.data))},dependencies:[p.sg]})}return a})();var _=r(3279);const R=["chart"];function U(a,c){if(1&a&&(t.TgZ(0,"div",1),t._UZ(1,"apx-chart",2),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.Q6J("series",e.chartOptions.series)("chart",e.chartOptions.chart)("dataLabels",e.chartOptions.dataLabels)("plotOptions",e.chartOptions.plotOptions)("yaxis",e.chartOptions.yaxis)("legend",e.chartOptions.legend)("fill",e.chartOptions.fill)("stroke",e.chartOptions.stroke)("tooltip",e.chartOptions.tooltip)("xaxis",e.chartOptions.xaxis)}}let A=(()=>{class a{constructor(e){this.sharedvar=e,this.data=[],this.category="_id",this.target="_id",this.chunk=0,this.onSelect=new t.vpe,this.chunkSize=0,this.sliceChunk=[],this.chartOptions={series:[{name:"Net Profit",data:[44,55,57,56,61,58,63,60,66]},{name:"Revenue",data:[76,85,101,98,87,105,91,114,94]},{name:"Free Cash Flow",data:[35,41,36,26,45,48,52,53,41]}],chart:{type:"bar",height:350},plotOptions:{bar:{horizontal:!1,columnWidth:"55%"}},dataLabels:{enabled:!1},stroke:{show:!0,width:2,colors:["transparent"]},xaxis:{categories:["Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct"]},yaxis:{title:{text:"$ (thousands)"}},fill:{opacity:1},tooltip:{y:{formatter:function(i){return"$ "+i+" thousands"}}}}}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(g.D))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-column"]],viewQuery:function(i,n){if(1&i&&t.Gf(R,5),2&i){let o;t.iGM(o=t.CRH())&&(n.chart=o.first)}},inputs:{data:"data",header:"header",category:"category",target:"target",chunk:"chunk"},outputs:{onSelect:"onSelect"},decls:1,vars:1,consts:[["id","chart",4,"ngIf"],["id","chart"],[3,"series","chart","dataLabels","plotOptions","yaxis","legend","fill","stroke","tooltip","xaxis"]],template:function(i,n){1&i&&t.YNc(0,U,2,10,"div",0),2&i&&t.Q6J("ngIf",n.data&&n.data.length>0)},dependencies:[p.O5,_.x]})}return a})();const D=["editControlTrigger"];function M(a,c){if(1&a&&t._UZ(0,"app-table",19),2&a){const e=t.oxw();t.Q6J("data",e.dataList)("header",e.filterHeader)}}function N(a,c){if(1&a&&t._UZ(0,"app-column",20),2&a){const e=t.oxw();t.Q6J("data",e.dataList)}}function Y(a,c){1&a&&(t.TgZ(0,"mat-icon"),t._uU(1,"Porcentajes"),t.qZA())}const E=[{path:"",component:(()=>{class a{constructor(e,i,n,o,m){this.sharedvar=e,this.dtb=i,this.dg=n,this.data2excel=o,this.ds=m,this.header={},this.filterHeader=new Map,this.yAxis="_id",this.xAxis="_id",this.chunk="D",this.windType="T"}ngOnInit(){var e=this;return(0,f.Z)(function*(){const i=new Date,n=i.setHours(0,0,0,0),o=i.setHours(23,59,59,999);e.localFilter={crm:"F",staff__id:[],pollGrpData:[],costumers:[],products:[],products_name_sel:[],date_all:!1,date_ini:n,date_end:o},e.filterDialog()})()}getTitleText(){return"header titulo"}getClicked(e){switch(e.index){case 1:this.filterDialog();break;case 3:let i=document.getElementById("spanTrigger");i&&(i.style.display="",i.style.position="absolute",i.style.left=e.pageX+5+"px",i.style.top=e.pageY+5+"px",this.editControlTrigger.openMenu())}}filterDialog(){var e=this;return(0,f.Z)(function*(){e.sharedvar.wait=!0;let i=[],n=[];(yield e.dtb.getStaffByFilterAsync({queryType:3,active:!0,stars:0,rol:"K"})).forEach(l=>{i.push({key:l._id,value:`${l.names||l.email} ${l.lastnames||""}`})}),(yield e.dtb.getPollGrpActiveAsync()).forEach(l=>{"index"!==l.id&&n.push({key:l._id,value:l.name})}),e.dg.aDefault({schema:{controls:[{name:"pollGrpData",label:"Formulario:",type:"select",style:"w-full",validators:{required:!0},selectOptions:n},{name:"staff__id",label:"Taskers:",type:"multiselect",style:"w-full",placeholder:"Asignados a \xe9sta formulario",validators:{},selectOptions:i},{name:"date_ini",label:"Fecha inicio:",type:"date",validators:{}},{name:"date_end",label:"Fecha final:",type:"date",validators:{}}]},title:"Filtros",dgheigth:500,dgwidth:550,value:e.localFilter}).subscribe(function(){var l=(0,f.Z)(function*(s){if(e.sharedvar.wait=!1,s){if(s.alldates)s.date_ini=0,s.date_end=0;else{let d=new Date(s.date_ini);s.date_ini=d.setHours(0,0,0,0),d=new Date(s.date_end),s.date_end=d.setHours(23,59,59,999)}e.localFilter={crm:"F",staff__id:s.staff__id,pollGrpData:s.pollGrpData,costumers:s.costumers,products:s.products,date_all:!1,date_ini:s.date_ini,date_end:s.date_end,products_name_sel:[]},yield e.dtb.getPollGrpAnaliticAsync(e.localFilter).then(d=>{e.dataList=d.data,e.header=d.header,e.filterHeader=new Map(Object.entries(d.header))})}});return function(s){return l.apply(this,arguments)}}())})()}getXYAxis(e){this.onExportexcel()}setChunk(){}changeWindType(e){this.windType=e||"T"}onExportexcel(){const e=`Reporte Actividad fechas ${this.sharedvar.formatNumber2Date(this.localFilter.date_ini||0,"-")} - \n    ${this.sharedvar.formatNumber2Date(this.localFilter.date_end||0,"-")}`;this.data2excel.excelExport(this.dataList,e,"Actividad",this.header,[])}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(g.D),t.Y36(b.k),t.Y36(Z.x),t.Y36(C.Z),t.Y36(F.n))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-activity-report"]],viewQuery:function(i,n){if(1&i&&t.Gf(D,5),2&i){let o;t.iGM(o=t.CRH())&&(n.editControlTrigger=o.first)}},decls:47,vars:8,consts:[[1,"flex","flex-col","max-h-screen"],[3,"buttons","nav_menu","bar_text","onClicked"],["id","spanTrigger",3,"matMenuTriggerFor"],["editControlTrigger","matMenuTrigger"],[1,"flex-1","m-2","bg-gray-100","overflow-scroll"],[1,"border","border-gray-200","rounded-sm","shadow-lg"],["class","h-96",3,"data","header",4,"ngIf"],[3,"data",4,"ngIf"],[1,"align-middle","justify-end"],["color","primary","mat-flat-button","",3,"click"],["color","warn","mat-flat-button","",3,"click"],["controlEdit","matMenu"],["mat-menu-item","",3,"click"],["color","primary"],[4,"ngIf"],[1,"mt-1","text-violet-500","text-lg","font-medium"],["mat-menu-item",""],[1,"ml-1","mt-1","text-violet-500","text-lg","font-medium"],[1,"ml-3"],[1,"h-96",3,"data","header"],[3,"data"]],template:function(i,n){if(1&i&&(t.TgZ(0,"div",0)(1,"app-header",1),t.NdJ("onClicked",function(m){return n.getClicked(m)}),t.qZA(),t._UZ(2,"span",2,3),t.TgZ(4,"div",4)(5,"div",5),t.YNc(6,M,1,2,"app-table",6),t.YNc(7,N,1,1,"app-column",7),t.qZA()(),t.TgZ(8,"div",8)(9,"button",9),t.NdJ("click",function(){return n.changeWindType("T")}),t.TgZ(10,"span"),t._uU(11,"Tabla"),t.qZA()(),t._uU(12," \xa0 "),t.TgZ(13,"button",10),t.NdJ("click",function(){return n.changeWindType("G")}),t.TgZ(14,"span"),t._uU(15,"Gr\xe1fica"),t.qZA()()()(),t.TgZ(16,"mat-menu",null,11)(18,"button",12),t.NdJ("click",function(){return n.getXYAxis("X")}),t.TgZ(19,"mat-icon",13),t._uU(20,"trending_up"),t.qZA(),t._uU(21),t.qZA(),t.TgZ(22,"button",12),t.NdJ("click",function(){return n.getXYAxis("E")}),t.TgZ(23,"mat-icon",13),t._uU(24,"trending_up"),t.qZA(),t._uU(25," Elementos de la gr\xe1fica "),t.qZA(),t.TgZ(26,"button",12),t.NdJ("click",function(){return n.setChunk()}),t.YNc(27,Y,2,0,"mat-icon",14),t._uU(28," trozos del eje X "),t.qZA(),t._UZ(29,"hr"),t.TgZ(30,"h2",15)(31,"mat-icon"),t._uU(32,"trending_up"),t.qZA(),t._uU(33,"\xa0Inteligencia Artificial "),t.qZA(),t.TgZ(34,"div")(35,"button",16),t._uU(36," An\xe1lisis con soporte de IA "),t.qZA()(),t._UZ(37,"hr"),t.TgZ(38,"h2",17)(39,"mat-icon"),t._uU(40,"file_download"),t.qZA(),t._uU(41,"\xa0Exportar"),t.qZA(),t.TgZ(42,"div",18)(43,"button",12),t.NdJ("click",function(){return n.getXYAxis("L")}),t._uU(44," Exportar Informe a Excel. "),t.qZA(),t.TgZ(45,"button",16),t._uU(46," Enviar Informe a Google Spread Sheet "),t.qZA()()()),2&i){const o=t.MAs(17);t.xp6(1),t.Q6J("buttons","110100")("nav_menu",!1)("bar_text",n.getTitleText()),t.xp6(1),t.Q6J("matMenuTriggerFor",o),t.xp6(4),t.Q6J("ngIf","T"===n.windType),t.xp6(1),t.Q6J("ngIf","G"===n.windType),t.xp6(14),t.hij(" Categor\xeda: ",n.xAxis," "),t.xp6(6),t.Q6J("ngIf","D"===n.chunk)}},dependencies:[p.O5,O.G,h.VK,h.OP,h.p6,T.Hw,v.lW,x,A]})}return a})()}];let G=(()=>{class a{static#t=this.\u0275fac=function(i){return new(i||a)};static#e=this.\u0275mod=t.oAB({type:a});static#a=this.\u0275inj=t.cJS({imports:[u.Bz.forChild(E),u.Bz]})}return a})();var Q=r(769),L=r(1359);const S=[{path:"",component:x}];let B=(()=>{class a{static#t=this.\u0275fac=function(i){return new(i||a)};static#e=this.\u0275mod=t.oAB({type:a});static#a=this.\u0275inj=t.cJS({imports:[u.Bz.forChild(S),u.Bz]})}return a})(),I=(()=>{class a{static#t=this.\u0275fac=function(i){return new(i||a)};static#e=this.\u0275mod=t.oAB({type:a});static#a=this.\u0275inj=t.cJS({imports:[p.ez,B]})}return a})();const X=[{path:"",component:A}];let z=(()=>{class a{static#t=this.\u0275fac=function(i){return new(i||a)};static#e=this.\u0275mod=t.oAB({type:a});static#a=this.\u0275inj=t.cJS({imports:[u.Bz.forChild(X),u.Bz]})}return a})(),j=(()=>{class a{static#t=this.\u0275fac=function(i){return new(i||a)};static#e=this.\u0275mod=t.oAB({type:a});static#a=this.\u0275inj=t.cJS({imports:[p.ez,z,_.X]})}return a})(),$=(()=>{class a{static#t=this.\u0275fac=function(i){return new(i||a)};static#e=this.\u0275mod=t.oAB({type:a});static#a=this.\u0275inj=t.cJS({imports:[p.ez,G,Q.O,L.ZX,_.X,h.Tx,T.Ps,v.ot,I,j]})}return a})()}}]);