"use strict";(self.webpackChunktasky_supplier=self.webpackChunktasky_supplier||[]).push([[76],{8076:(F,v,l)=>{l.r(v),l.d(v,{CategListModule:()=>N});var h=l(7087),f=l(3759),p=l(3241),t=l(2283),y=l(6806),b=l(3638),x=l(1359),w=l(8937),k=l(3578),g=l(9347),C=l(8464);function Z(r,u){if(1&r){const e=t.EpF();t.TgZ(0,"div",41)(1,"div",42)(2,"div",43),t._uU(3),t.qZA(),t.TgZ(4,"div",44),t._uU(5,"Agregar a filtro de b\xfasqueda: "),t.TgZ(6,"span",45),t._uU(7),t.qZA(),t._uU(8," - Tipo de campo: "),t.TgZ(9,"span",46),t._uU(10),t.qZA(),t._uU(11," - Lista de selecci\xf3n: "),t.TgZ(12,"span",46),t._uU(13),t.qZA()(),t.TgZ(14,"mat-icon",36),t.NdJ("click",function(){const s=t.CHM(e).index,c=t.oxw().index,o=t.oxw(3).$implicit,n=t.oxw();return t.KtG(n.swapElementItem(o,c,s))}),t._uU(15,"swap_vert"),t.qZA(),t.TgZ(16,"mat-icon",36),t.NdJ("click",function(){const s=t.CHM(e).index,c=t.oxw().index,o=t.oxw(3).$implicit,n=t.oxw();return t.KtG(n.addEditElementItem(o,c,s))}),t._uU(17,"edit"),t.qZA(),t.TgZ(18,"mat-icon",47),t.NdJ("click",function(){const s=t.CHM(e).index,c=t.oxw().index,o=t.oxw(3).$implicit,n=t.oxw();return t.KtG(n.deleteCharactItem(o,c,s))}),t._uU(19,"delete"),t.qZA()()()}if(2&r){const e=u.$implicit;t.xp6(3),t.hij(" ",e.title,": "),t.xp6(4),t.Oqu(e.add2filter),t.xp6(3),t.Oqu(e.type),t.xp6(3),t.Oqu(e.select)}}function T(r,u){if(1&r){const e=t.EpF();t.TgZ(0,"div",31)(1,"div",32)(2,"div",33)(3,"div",34)(4,"div",35),t._uU(5),t.qZA(),t._uU(6," \xa0 "),t.TgZ(7,"mat-icon",36),t.NdJ("click",function(){const s=t.CHM(e).index,c=t.oxw(3).$implicit,o=t.oxw();return t.KtG(o.swapPropItem(c,s))}),t._uU(8,"swap_vert"),t.qZA(),t.TgZ(9,"mat-icon",37),t.NdJ("click",function(){const s=t.CHM(e).index,c=t.oxw(3).$implicit,o=t.oxw();return t.KtG(o.addEditCharactHeader(c,s))}),t._uU(10,"edit"),t.qZA(),t.TgZ(11,"mat-icon",23),t.NdJ("click",function(){const s=t.CHM(e).index,c=t.oxw(3).$implicit,o=t.oxw();return t.KtG(o.deleteHeader(c,s))}),t._uU(12,"delete"),t.qZA()(),t.TgZ(13,"div",38)(14,"div",39),t._uU(15,"Elementos de las propiedades"),t.qZA(),t.TgZ(16,"div")(17,"mat-icon",22),t.NdJ("click",function(){const s=t.CHM(e).index,c=t.oxw(3).$implicit,o=t.oxw();return t.KtG(o.addEditElementItem(c,s,-1))}),t._uU(18,"add"),t.qZA()()()(),t.YNc(19,Z,20,4,"div",40),t.qZA()()}if(2&r){const e=u.$implicit;t.xp6(5),t.Oqu(e.header),t.xp6(14),t.Q6J("ngForOf",e.data)}}function L(r,u){if(1&r){const e=t.EpF();t.TgZ(0,"div")(1,"div",26),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2).$implicit,s=t.oxw();return t.KtG(s.addEditCharactHeader(a,-1))}),t.TgZ(2,"div",27),t._uU(3,"Propiedades"),t.qZA(),t._uU(4," \xa0 "),t.TgZ(5,"mat-icon",28),t._uU(6,"add"),t.qZA()(),t.TgZ(7,"div",29),t.YNc(8,T,20,2,"div",30),t.qZA()()}if(2&r){const e=t.oxw(2).$implicit;t.xp6(8),t.Q6J("ngForOf",e.characterList)}}function A(r,u){if(1&r){const e=t.EpF();t.TgZ(0,"div",13)(1,"div",14)(2,"div",15),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(),s=a.$implicit,c=a.index,o=t.oxw();return t.KtG(o.addEditCategory(s,c))}),t._UZ(3,"img",16),t.qZA(),t.TgZ(4,"div",17)(5,"div",18)(6,"mat-icon",19),t._uU(7),t.qZA(),t.TgZ(8,"div",20),t._uU(9),t.qZA()(),t.TgZ(10,"div",21)(11,"mat-icon",22),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(),s=a.$implicit,c=a.index,o=t.oxw();return t.KtG(o.addEditCategory(s,c))}),t._uU(12,"edit"),t.qZA(),t.TgZ(13,"mat-icon",22),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().index,s=t.oxw();return t.KtG(s.switchSubView(a))}),t._uU(14,"expand_more"),t.qZA(),t._uU(15," \xa0 "),t.TgZ(16,"mat-icon",23),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().index,s=t.oxw();return t.KtG(s.deleteCategory(a))}),t._uU(17,"delete"),t.qZA(),t.TgZ(18,"div",24),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,s=t.oxw();return t.KtG(s.categLevel(a,1))}),t.TgZ(19,"span"),t._uU(20,"Sub categor\xeda"),t.qZA(),t.TgZ(21,"mat-icon"),t._uU(22,"chevron_right"),t.qZA()()()()(),t.YNc(23,L,9,1,"div",25),t.qZA()}if(2&r){const e=t.oxw(),i=e.$implicit,a=e.index,s=t.oxw();t.xp6(3),t.Q6J("src",s.getCategImage(i),t.LSH),t.xp6(4),t.Oqu(s.getCategVisible(i.visible)),t.xp6(2),t.Oqu(i.name),t.xp6(14),t.Q6J("ngIf",s.getSubView(a))}}function U(r,u){if(1&r&&(t.TgZ(0,"div"),t.YNc(1,A,24,4,"div",12),t.qZA()),2&r){const e=u.$implicit,i=t.oxw();t.xp6(1),t.Q6J("ngIf",i.getCateg2Show(e))}}const q=[{path:"",component:(()=>{class r{constructor(e,i,a,s){this.dtb=e,this.dg=i,this.snkBar=a,this.sanitizer=s,this.categ_list=[],this.subView=-1,this.categShow=[{_id:"root",title:"Raiz"}],this.categorySchema={controls:[{name:"_id",label:"C\xf3digo:",type:"text",style:"w-full",disabled:!0,validators:{required:!0}},{name:"name",label:"Nombre de la categor\xeda:",type:"text",style:"w-full",validators:{required:!0}},{name:"description",label:"Descripci\xf3n:",type:"textarea",style:"w-full",totalRows:2,validators:{}},{name:"visible",label:"Visible",type:"checkbox",validators:{}},{name:"indexCategory",label:"Viene de...",type:"multiselect",style:"w-full",selectOptions:[],validators:{}}]},this.characteristic={controls:[{name:"header",label:"T\xedtulo:",type:"text",style:"w-full",validators:{required:!0}},{name:"duplicable",label:"Duplicable",type:"checkbox",validators:{}}]},this.charactItem={controls:[{name:"id",label:"C\xf3digo:",type:"text",disabled:!0,validators:{}},{name:"title",label:"T\xedtulo del elemento:",type:"text",style:"w-full",validators:{required:!0}},{name:"add2filter",label:"Agregar a los filtros de b\xfasqueda",type:"checkbox",validators:{required:!0}},{name:"type",label:"Tipo de campo:",type:"select",selectOptions:[{key:"prod_id",value:"Item C\xf3digo"},{key:"prod_name",value:"Item Nombre"},{key:"prod_name_long",value:"Item Descripci\xf3n"},{key:"prod_stock",value:"Item Existencia"},{key:"prod_tax_p",value:"Item Impuesto %"},{key:"prod_price",value:"Item Precio"},{key:"prod_chip",value:"Item Chips"},{key:"prod_star",value:"Item Calificaci\xf3n"},{key:"prod_opinion",value:"Item Opini\xf3n"},{key:"text",value:"Texto"},{key:"text_box",value:"Texto Largo"},{key:"number",value:"N\xfamero"},{key:"checkbox",value:"si/no"},{key:"avatar",value:"Foto/Imagen (v\xednculo)"},{key:"box",value:"Rect\xe1ngulo + Texto"},{key:"circle",value:"Circulo + Imagen (v\xednculo)"}],style:"w-72",validators:{required:!0}},{name:"select",label:"Lista de selecci\xf3n",type:"checkbox",default:"false",validators:{required:!0}},{name:"selectlist",label:"Listado:",type:"select",sideBtn:"expand_more",selectOptions:[],disabled:!0,style:"w-full",validators:{}},{name:"source",label:"Fuente de los datos (http)",type:"text",style:"w-full",sideBtn:"http",validators:{}}]}}ngOnInit(){var e=this;return(0,p.Z)(function*(){e.getCategories()})()}getCategories(){var e=this;return(0,p.Z)(function*(){e.categ_list=(yield e.dtb.getAllCategAsync())||[],e.categShow=[{_id:"root",title:"Raiz"}],e.categ_list.sort((i,a)=>i.name.toLowerCase()<a.name.toLowerCase()?-1:1)})()}getClicked(e){var i=this;return(0,p.Z)(function*(){switch(e.index){case 1:case 3:break;case 2:i.addEditCategory(null,-1);break;case 4:yield i.getCategories()}})()}getCateg2Show(e){return!!(1===this.categShow.length&&0===e.indexCategory.length||e.indexCategory?.includes(this.categShow[this.categShow.length-1]._id))}categLevel(e,i){var a=this;return(0,p.Z)(function*(){if(-1===i&&a.categShow.length>1)a.categShow.splice(a.categShow.length-1,1);else{if(null===e)return yield a.getCategories();a.categShow.push({_id:e._id,title:e.name})}})()}getCategVisible(e){return e?"visibility":"visibility_off"}addEditCategory(e,i=-1){let a=-1===i;a&&(e={_id:this.dtb.nextConsecutive("C",3,!0,this.categ_list,"_id"),name:"",characterList:[],visible:!0,indexCategory:[]},this.categShow.length>1&&e.indexCategory?.push(this.categShow[this.categShow.length-1]._id));const s=[];if(this.categ_list.forEach(o=>{e._id!==o._id&&s.push({key:o._id,value:o.name})}),s.length>0&&this.categorySchema.controls){const o=this.categorySchema.controls.find(n=>"indexCategory"===n.name);o&&(o.selectOptions=s)}let c={schema:this.categorySchema,value:e,title:"Categor\xeda",showImage:!0,image:e.picture,imgwidth:400,imgheight:400,dgheigth:715};this.dg.aDefault(c).subscribe(o=>{o&&(delete o._propName_,delete o._valid_,this.dg.updatePropResult(e,o),c.image&&e&&(e.picture=c.image),a?this.categ_list.push(e):this.categ_list[i]=e,this.dtb.setCategory(e,a))})}deleteCategory(e){this.snkBar.open("Eliminar "+this.categ_list[e].name,"Ok",{duration:7e3}).onAction().subscribe(i=>{this.dtb.deleteCategory(this.categ_list[e]._id),this.categ_list.splice(e,1)})}addEditCharactHeader(e,i){let a=!1,s=e.characterList[i];if(-1===i){const o=this.dtb.getSerialKey(2,4);s={pos:0,cat_id:e._id,id:o,header:"",duplicable:!1,data:[]},a=!0}this.dg.aDefault({schema:this.characteristic,value:s,title:"T\xedtulo de la caracter\xedstica",dgheigth:265}).subscribe(o=>{if(o){if(delete o._propName_,delete o._valid_,this.dg.updatePropResult(s,o),a){let n=0;e.characterList.forEach(d=>{d.pos=n,n++}),s.pos=n,e.characterList.push(s)}else e.characterList[i]=s;this.dtb.setCategory(e,!1)}})}deleteHeader(e,i){const a=e.characterList[i];a&&this.snkBar.open("Eliminar "+a.header,"Ok",{duration:7e3}).onAction().subscribe(s=>{e.characterList.splice(i,1),this.dtb.setCategory(e,!1)})}swapPropItem(e,i){if(i>0){const a=e.characterList[i].pos;i--;const s=e.characterList[i].pos;e.characterList[i].pos=a,i++,e.characterList[i].pos=s,e.characterList.sort((c,o)=>c.pos-o.pos),this.dtb.setCategory(e,!1)}}addEditElementItem(e,i,a){let s=!0,o={pos:0,id:this.dtb.getSerialKey(2,4),title:"",type:"",select:!1,add2filter:!1,selectlist:[]};if(a>=0&&e.characterList[i].data[a]&&(o=e.characterList[i].data[a],s=!1),o.selectlist&&o.selectlist.length>0){const d=this.charactItem.controls?.find(m=>"selectlist"===m.name);d&&(d.selectOptions=[],o.selectlist.forEach(m=>d.selectOptions?.push({key:m.key,value:m.value})))}this.dg.aDefault({schema:this.charactItem,value:o,title:"Propiedades de: "+e.characterList[i].header,dgwidth:600,dgheigth:660,function:[]}).subscribe(d=>{if(d){delete d._propName_,delete d._valid_,delete d.selectlist,d.type.includes("prod")&&(d.select=!1);const m=this.charactItem.controls?.find(_=>"selectlist"===_.name);if(m&&(o.selectlist=[],m.selectOptions?.forEach(_=>{o.selectlist?.push({id:`${o.id}_${_.key}`,key:_.key,value:_.value})})),this.dg.updatePropResult(o,d),s){let _=0;e.characterList[i].data.forEach(J=>{J.pos=_,_++}),o.pos=_,e.characterList[i].data.push(o)}else e.characterList[i].data[a]=o;this.dtb.setCategory(e,!1)}})}swapElementItem(e,i,a){if(a>0){const s=e.characterList[i].data[a].pos;a--;const c=e.characterList[i].data[a].pos;e.characterList[i].data[a].pos=s,a++,e.characterList[i].data[a].pos=c,e.characterList[i].data.sort((o,n)=>o.pos-n.pos),this.dtb.setCategory(e,!1)}}deleteCharactItem(e,i,a){const s=e.characterList[i].data[a];s&&this.snkBar.open("Eliminar "+s.title,"Ok",{duration:7e3}).onAction().subscribe(c=>{e.characterList[i].data.splice(a,1),this.dtb.setCategory(e,!1)})}switchSubView(e){this.subView=this.subView===e?-1:e}getSubView(e){return this.subView===e}getCategImage(e){return e.picture?this.sanitizer.bypassSecurityTrustUrl(e.picture):""}fileChangeEvent(e,i=null){}static#t=this.\u0275fac=function(i){return new(i||r)(t.Y36(y.k),t.Y36(b.x),t.Y36(x.ux),t.Y36(w.H7))};static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["app-categ-list"]],decls:26,vars:5,consts:[[1,"flex","flex-col","max-h-screen"],[3,"buttons","nav_menu","onClicked"],["id","spanTrigger",3,"matMenuTriggerFor"],["editControlTrigger","matMenuTrigger"],[1,"flex-1","px-1","pt-1","bg-gray-100","overflow-auto"],[1,"flex","font-medium","mb-2","text-gray-400","hover:text-black",3,"click"],[4,"ngFor","ngForOf"],["products","matMenu"],[1,"font-medium"],["color","primary"],["color","primary",1,"mt-1"],["mat-menu-item",""],["class","p-1 flex flex-col bg-white border border-gray-500 mb-2",4,"ngIf"],[1,"p-1","flex","flex-col","bg-white","border","border-gray-500","mb-2"],[1,"flex","justify-start"],[1,"w-30",3,"click"],[1,"h-16","w-16","border","border-gray-400","py-1","px-1","rounded-full","shadow-sm",3,"src"],[1,"grow","ml-2","flex","flex-col"],[1,"flex","justify-start","font-medium"],[1,"text-gray-800"],[1,"ml-2"],[1,"mt-1","flex","justify-end","text-sky-200","bg-gray-100"],[1,"hover:text-sky-500",3,"click"],[1,"hover:text-red-500",3,"click"],[1,"ml-12","flex","text-gray-400","font-medium","hover:text-black",3,"click"],[4,"ngIf"],[1,"mt-2","flex","px-1","text-sm","bg-gray-100",3,"click"],[1,"mt-1","font-medium","text-gray-400","hover:text-black"],[1,"w-20","text-sky-200","hover:text-sky-500"],[1,"flex","flex-col","mx-2","mt-1","text-sm"],["class","mt-2",4,"ngFor","ngForOf"],[1,"mt-2"],[1,"border","border-gray-300"],[1,"flex","flex-row","align-middle","bg-gray-100"],[1,"grow","flex","flex-row","items-center","justify-center","text-sky-200"],[1,"text-center","font-medium","text-black"],[1,"text-sky-200","hover:text-sky-500",3,"click"],[1,"w-20","ml-1","hover:text-sky-500",3,"click"],[1,"w-40","flex","flex-row","items-end","justify-end","align-middle","font-medium","text-sm","text-sky-200"],[1,"text-gray-400","hover:text-black"],["class","flex flex-col",4,"ngFor","ngForOf"],[1,"flex","flex-col"],[1,"pt-2","flex","justify-items-start","align-middle","bg-white"],[1,"px-1","font-medium","text-sm"],[1,"grow","px-1","text-xs"],[1,"text-gray-400"],[1,"text-gray-500"],[1,"text-sky-200","hover:text-red-500",3,"click"]],template:function(i,a){if(1&i&&(t.TgZ(0,"div",0)(1,"app-header",1),t.NdJ("onClicked",function(c){return a.getClicked(c)}),t.qZA(),t._UZ(2,"span",2,3),t.TgZ(4,"div",4)(5,"div",5),t.NdJ("click",function(){return a.categLevel(null,-1)}),t.TgZ(6,"mat-icon"),t._uU(7,"chevron_left"),t.qZA(),t.TgZ(8,"div"),t._uU(9),t.qZA()(),t.YNc(10,U,2,1,"div",6),t.qZA(),t.TgZ(11,"mat-menu",null,7)(13,"div",8)(14,"mat-icon",9),t._uU(15,"cloud_upload"),t.qZA(),t._uU(16," Base remota "),t.qZA(),t._UZ(17,"hr"),t.TgZ(18,"div",8)(19,"mat-icon",10),t._uU(20,"edit"),t.qZA(),t._uU(21," Base local "),t.qZA(),t.TgZ(22,"button",11),t._uU(23," Data base hacia Excel "),t.qZA(),t.TgZ(24,"button",11),t._uU(25," Lista de im\xe1genes en la base "),t.qZA()()()),2&i){const s=t.MAs(12);t.xp6(1),t.Q6J("buttons","111111")("nav_menu",!1),t.xp6(1),t.Q6J("matMenuTriggerFor",s),t.xp6(7),t.Oqu(a.categShow[a.categShow.length-1].title),t.xp6(1),t.Q6J("ngForOf",a.categ_list)}},dependencies:[h.sg,h.O5,k.G,g.VK,g.OP,g.p6,C.Hw]})}return r})()}];let E=(()=>{class r{static#t=this.\u0275fac=function(i){return new(i||r)};static#e=this.\u0275mod=t.oAB({type:r});static#i=this.\u0275inj=t.cJS({imports:[f.Bz.forChild(q),f.Bz]})}return r})();var S=l(769),O=l(7572);let N=(()=>{class r{static#t=this.\u0275fac=function(i){return new(i||r)};static#e=this.\u0275mod=t.oAB({type:r});static#i=this.\u0275inj=t.cJS({imports:[h.ez,E,S.O,g.Tx,C.Ps,x.ZX,O.N]})}return r})()}}]);