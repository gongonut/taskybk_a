"use strict";(self.webpackChunktasky_supplier=self.webpackChunktasky_supplier||[]).push([[76],{8076:(J,g,l)=>{l.r(g),l.d(g,{CategListModule:()=>E});var m=l(7087),p=l(3759),h=l(3241),t=l(2283),v=l(6806),C=l(8376),x=l(1359),b=l(3578),_=l(9347),f=l(8464);function y(o,d){if(1&o){const e=t.EpF();t.TgZ(0,"div",28)(1,"div",41)(2,"div",42),t._uU(3),t.qZA(),t.TgZ(4,"div",43),t._uU(5),t.qZA(),t.TgZ(6,"mat-icon",44),t.NdJ("click",function(){const a=t.CHM(e).index,r=t.oxw().index,c=t.oxw(2).$implicit,n=t.oxw();return t.KtG(n.addEditCharactItem(c,r,a))}),t._uU(7,"edit"),t.qZA(),t.TgZ(8,"mat-icon",45),t.NdJ("click",function(){const a=t.CHM(e).index,r=t.oxw().index,c=t.oxw(2).$implicit,n=t.oxw();return t.KtG(n.deleteCharactItem(c,r,a))}),t._uU(9,"delete"),t.qZA()()()}if(2&o){const e=d.$implicit;t.xp6(3),t.Oqu(e.title),t.xp6(2),t.Oqu(e.type)}}function Z(o,d){if(1&o){const e=t.EpF();t.TgZ(0,"div",32)(1,"div",33)(2,"div",34)(3,"div",35)(4,"div",36),t._uU(5),t.qZA(),t.TgZ(6,"mat-icon",37),t.NdJ("click",function(){const a=t.CHM(e).index,r=t.oxw(2).$implicit,c=t.oxw();return t.KtG(c.addEditCharactHeader(r,a))}),t._uU(7,"edit"),t.qZA(),t.TgZ(8,"mat-icon",19),t.NdJ("click",function(){const a=t.CHM(e).index,r=t.oxw(2).$implicit,c=t.oxw();return t.KtG(c.deleteHeader(r,a))}),t._uU(9,"delete"),t.qZA()(),t.TgZ(10,"div",38)(11,"div",39),t._uU(12,"Elementos"),t.qZA(),t.TgZ(13,"div")(14,"mat-icon",19),t.NdJ("click",function(){const a=t.CHM(e).index,r=t.oxw(2).$implicit,c=t.oxw();return t.KtG(c.addEditCharactItem(r,a,-1))}),t._uU(15,"add"),t.qZA()()()(),t.YNc(16,y,10,2,"div",40),t.qZA()()}if(2&o){const e=d.$implicit;t.xp6(5),t.Oqu(e.header),t.xp6(11),t.Q6J("ngForOf",e.data)}}function w(o,d){if(1&o){const e=t.EpF();t.TgZ(0,"div",46)(1,"div",47)(2,"div",48),t._uU(3),t.qZA(),t.TgZ(4,"mat-icon",44),t.NdJ("click",function(){const a=t.CHM(e).index,r=t.oxw(2).$implicit,c=t.oxw();return t.KtG(c.addEditSubCategory(r,a))}),t._uU(5,"edit"),t.qZA(),t.TgZ(6,"mat-icon",49),t._uU(7,"delete"),t.qZA()()()}if(2&o){const e=d.$implicit;t.xp6(3),t.Oqu(e.name)}}function T(o,d){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"div",22),t.NdJ("click",function(){t.CHM(e);const s=t.oxw().$implicit,a=t.oxw();return t.KtG(a.addEditCharactHeader(s,-1))}),t.TgZ(2,"div",23),t._uU(3,"Carater\xedsticas"),t.qZA(),t._uU(4," \xa0 "),t.TgZ(5,"mat-icon",24),t._uU(6,"add"),t.qZA()(),t.TgZ(7,"div",25),t.YNc(8,Z,17,2,"div",26),t.qZA(),t._UZ(9,"div",27),t.TgZ(10,"div",28)(11,"div",29)(12,"div",7),t._uU(13,"Sub categor\xedas"),t.qZA(),t._uU(14," \xa0 "),t.TgZ(15,"mat-icon",30),t.NdJ("click",function(){t.CHM(e);const s=t.oxw().$implicit,a=t.oxw();return t.KtG(a.addEditSubCategory(s,-1))}),t._uU(16,"add"),t.qZA()(),t.YNc(17,w,8,1,"div",31),t.qZA()()}if(2&o){const e=t.oxw().$implicit;t.xp6(8),t.Q6J("ngForOf",e.characterList),t.xp6(9),t.Q6J("ngForOf",e.subCategory)}}function k(o,d){if(1&o){const e=t.EpF();t.TgZ(0,"div",11)(1,"div",12)(2,"div",13)(3,"label"),t._UZ(4,"img",14)(5,"div"),t.TgZ(6,"input",15),t.NdJ("click",function(){const a=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.fileChangeEvent(a,null))}),t.qZA()()(),t.TgZ(7,"div",16)(8,"div",7),t._uU(9),t.qZA(),t.TgZ(10,"div",17),t._uU(11),t.qZA()()(),t.TgZ(12,"div",18)(13,"mat-icon",19),t.NdJ("click",function(){const s=t.CHM(e),a=s.$implicit,r=s.index,c=t.oxw();return t.KtG(c.addEditCategory(a,r))}),t._uU(14,"edit"),t.qZA(),t.TgZ(15,"mat-icon",19),t.NdJ("click",function(){const a=t.CHM(e).index,r=t.oxw();return t.KtG(r.switchSubView(a))}),t._uU(16,"list"),t.qZA(),t._uU(17," \xa0 "),t.TgZ(18,"mat-icon",20),t._uU(19,"delete"),t.qZA()(),t.YNc(20,T,18,2,"div",21),t.qZA()}if(2&o){const e=d.$implicit,i=d.index,s=t.oxw();t.xp6(4),t.Q6J("src",s.getCategImage(e),t.LSH),t.xp6(5),t.Oqu(e.name),t.xp6(2),t.Oqu(e.description),t.xp6(9),t.Q6J("ngIf",s.getSubView(i))}}const A=[{path:"",component:(()=>{class o{constructor(e,i,s){this.dtb=e,this.dg=i,this.snkBar=s,this.categ_list=[],this.subView=-1,this.category={controls:[{name:"_id",label:"C\xf3digo:",type:"text",style:"w-full",disabled:!0,validators:{required:!0}},{name:"name",label:"Nombre de la categor\xeda:",type:"text",style:"w-full",validators:{required:!0}},{name:"description",label:"Descripci\xf3n:",type:"textarea",style:"w-full",totalRows:2,validators:{}},{name:"urlpicture",label:"Im\xe1gen:",type:"text",style:"w-5/6",sideBtn:"image",validators:{}}]},this.characteristic={controls:[{name:"header",label:"T\xedtulo:",type:"text",style:"w-full",validators:{required:!0}},{name:"duplicate",label:"Duplicable",type:"checkbox",validators:{}}]},this.CharactItem={controls:[{name:"title",label:"T\xedtulo de la carater\xedstica:",type:"text",style:"w-full",validators:{required:!0}},{name:"type",label:"Tipo:",type:"select",selectOptions:[{key:"number",value:"N\xfamero"},{key:"text",value:"Texto"},{key:"link",value:"V\xednculo"},{key:"picture",value:"Foto/Imagen"}],style:"w-full",validators:{required:!0}},{name:"add2filter",label:"Agregar a los filtros de b\xfasqueda",type:"checkbox",validators:{required:!0}},{name:"selectable",label:"Seleccionable",type:"checkbox",validators:{required:!0}},{name:"selectlist",label:"Lista de opciones para seleccionar (;)",type:"textarea",totalRows:4,style:"w-full",disabled:!0,validators:{}}]},this.SubCateg={controls:[{name:"id",label:"C\xf3digo:",type:"text",style:"w-full",disabled:!0,validators:{required:!0}},{name:"name",label:"Nombre de la categor\xeda:",type:"text",style:"w-full",validators:{required:!0}},{name:"urlpicture",label:"Im\xe1gen:",type:"text",style:"w-5/6",sideBtn:"image",validators:{}}]}}ngOnInit(){var e=this;return(0,h.Z)(function*(){e.categ_list=(yield e.dtb.getAllCategAsync())||[]})()}getClicked(e){var i=this;return(0,h.Z)(function*(){switch(e.index){case 1:case 3:break;case 2:i.addEditCategory(null,-1)}})()}addEditCategory(e,i=-1){let s=-1===i;if(s){let r="C000";this.categ_list.length>0&&(r=this.dtb.nextConsecutive("C",3,!0,this.categ_list[this.categ_list.length-1]._id)),e={_id:r,name:"",characterList:[]}}this.dg.aDefault({schema:this.category,value:e,title:"Categor\xeda",dgheigth:475}).subscribe(r=>{r&&(delete r._propName_,delete r._valid_,this.dg.updatePropResult(e,r),s?this.categ_list.push(e):this.categ_list[i]=e,this.dtb.setCategory(e,s))})}addEditCharactHeader(e,i){let s=!1,a=e.characterList[i];-1===i&&(a={_id:this.dtb.getSerialKey(2,4),header:"",duplicable:!1,data:[]},s=!0),this.dg.aDefault({schema:this.characteristic,value:a,title:"T\xedtulo de la caracter\xedstica",dgheigth:250}).subscribe(c=>{c&&(delete c._propName_,delete c._valid_,this.dg.updatePropResult(a,c),s?e.characterList.push(a):e.characterList[i]=a,this.dtb.setCategory(e,!1))})}deleteHeader(e,i){const s=e.characterList[i];s&&this.snkBar.open("Eliminar "+s.header,"Ok",{duration:7e3}).onAction().subscribe(a=>{e.characterList.splice(i,1),this.dtb.setCategory(e,!1)})}addEditCharactItem(e,i,s){let a=!0,n={_id:this.dtb.nextConsecutive("",4,!0,e.characterList[e.characterList.length-1]._id),title:"",selectable:!1,add2filter:!1,select:[],type:"text",value:"",stock:0,pictures:[]};if(s>=0&&e.characterList[i].data[s]&&(n=e.characterList[i].data[s],a=!1),this.CharactItem.controls){const u=this.CharactItem.controls.findIndex(F=>"selectlist"===F.name);u&&u>=0&&(this.CharactItem.controls[u].disabled=!n.selectable)}this.dg.aDefault({schema:this.CharactItem,value:n,title:"Datos de "+e.characterList[i].header,dgheigth:530,function:[{name:"selectable",self:this,function:this.optionEditable}]}).subscribe(u=>{u&&(delete u._propName_,delete u._valid_,this.dg.updatePropResult(n,u),a?e.characterList[i].data.push(n):e.characterList[i].data[s]=n,this.dtb.setCategory(e,!1))})}optionEditable(e,i,s){if(e.CharactItem.controls){const a=e.CharactItem.controls.findIndex(r=>"selectlist"===r.name);if(a&&a>=0)return e.CharactItem.controls[a].disabled=!i.selectable,i.selectable||(i.selectlist=""),{schema:e.CharactItem,value:i}}return""}deleteCharactItem(e,i,s){const a=e.characterList[i].data[s];a&&this.snkBar.open("Eliminar "+a.title,"Ok",{duration:7e3}).onAction().subscribe(r=>{e.characterList[i].data.splice(s,1),this.dtb.setCategory(e,!1)})}addEditSubCategory(e,i){let a,s=!1;e.subCategory&&(-1===i?(a={id:this.dtb.nextConsecutive(e._id+"_",3,!0,e.subCategory.length.toString()),name:""},s=!0):a=e.subCategory[i]),this.dg.aDefault({schema:this.SubCateg,value:a,title:"Subcategor\xeda",dgheigth:375}).subscribe(c=>{c&&(delete c._propName_,delete c._valid_,this.dg.updatePropResult(a,c),e.subCategory&&(s?e.subCategory?.push(a):e.subCategory[i]=a,this.dtb.setCategory(e,!1)))})}switchSubView(e){this.subView=this.subView===e?-1:e}getSubView(e){return this.subView===e}getCategImage(e){}fileChangeEvent(e,i=null){}static#t=this.\u0275fac=function(i){return new(i||o)(t.Y36(v.k),t.Y36(C.x),t.Y36(x.ux))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-categ-list"]],decls:21,vars:4,consts:[[1,"flex","flex-col","max-h-screen"],[3,"buttons","nav_menu","onClicked"],["id","spanTrigger",3,"matMenuTriggerFor"],["editControlTrigger","matMenuTrigger"],[1,"flex-1","px-1","pt-1","bg-gray-200","overflow-auto"],["class","p-1 flex flex-col bg-white border border-gray-500",4,"ngFor","ngForOf"],["products","matMenu"],[1,"font-medium"],["color","primary"],["color","primary",1,"mt-1"],["mat-menu-item",""],[1,"p-1","flex","flex-col","bg-white","border","border-gray-500"],[1,"flex","justify-start"],[1,"w-30"],["alt","Click to add image",1,"h-32","w-28","border","border-gray-400","py-1","px-1","rounded","shadow-sm",3,"src"],["accept",".png,.jpg,.jpeg",2,"display","none",3,"click"],[1,"grow","ml-2","flex","flex-col"],[1,"mt-1","font-thin","text-sm"],[1,"mt-1","flex","justify-end","text-gray-300","bg-gray-200"],[1,"hover:text-sky-500",3,"click"],[1,"hover:text-red-500"],[4,"ngIf"],[1,"mt-2","flex","px-1","text-sm","bg-gray-200","hover:text-sky-500",3,"click"],[1,"font-medium","text-black","mt-1"],[1,"w-20","text-gray-300","hover:text-sky-500"],[1,"flex","flex-col","mx-2","mt-1","text-sm"],["class","mt-2",4,"ngFor","ngForOf"],[1,"h-8","mt-3","border-t","border-gray-500"],[1,"flex","flex-col"],[1,"flex","px-1","text-sm","bg-gray-200"],[1,"w-20","text-gray-300","hover:text-sky-500",3,"click"],["class","flex flex-col bg-white text-gray-800",4,"ngFor","ngForOf"],[1,"mt-2"],[1,"border","border-gray-300"],[1,"flex","flex-row","align-middle"],[1,"grow","flex","flex-row","items-center","justify-center","text-gray-300"],[1,"text-center","font-medium","text-black"],[1,"w-20","ml-1","hover:text-sky-500",3,"click"],[1,"w-20","flex","flex-row","items-end","justify-end","align-middle","font-medium","text-sm","text-gray-300","w-40"],[1,"text-black"],["class","flex flex-col",4,"ngFor","ngForOf"],[1,"flex","justify-items-start","align-middle","divide-y","divide-x","divide-gray-300"],[1,"w-1/2","px-1","font-medium","text-sm","text-gray-800"],[1,"w-1/2","px-1","text-sm","bg-white"],[1,"text-gray-300","hover:text-sky-500",3,"click"],[1,"text-gray-300","hover:text-red-500",3,"click"],[1,"flex","flex-col","bg-white","text-gray-800"],[1,"flex","justify-items-start","align-middle"],[1,"grow","px-2","font-medium","text-sm","text-gray-800"],[1,"text-gray-300","hover:text-sky-500"]],template:function(i,s){if(1&i&&(t.TgZ(0,"div",0)(1,"app-header",1),t.NdJ("onClicked",function(r){return s.getClicked(r)}),t.qZA(),t._UZ(2,"span",2,3),t.TgZ(4,"div",4),t.YNc(5,k,21,4,"div",5),t.qZA(),t.TgZ(6,"mat-menu",null,6)(8,"div",7)(9,"mat-icon",8),t._uU(10,"cloud_upload"),t.qZA(),t._uU(11," Base remota "),t.qZA(),t._UZ(12,"hr"),t.TgZ(13,"div",7)(14,"mat-icon",9),t._uU(15,"edit"),t.qZA(),t._uU(16," Base local "),t.qZA(),t.TgZ(17,"button",10),t._uU(18," Data base hacia Excel "),t.qZA(),t.TgZ(19,"button",10),t._uU(20," Lista de im\xe1genes en la base "),t.qZA()()()),2&i){const a=t.MAs(7);t.xp6(1),t.Q6J("buttons","111111")("nav_menu",!1),t.xp6(1),t.Q6J("matMenuTriggerFor",a),t.xp6(3),t.Q6J("ngForOf",s.categ_list)}},dependencies:[m.sg,m.O5,b.G,_.VK,_.OP,_.p6,f.Hw]})}return o})()}];let L=(()=>{class o{static#t=this.\u0275fac=function(i){return new(i||o)};static#e=this.\u0275mod=t.oAB({type:o});static#i=this.\u0275inj=t.cJS({imports:[p.Bz.forChild(A),p.Bz]})}return o})();var q=l(769),U=l(7572);let E=(()=>{class o{static#t=this.\u0275fac=function(i){return new(i||o)};static#e=this.\u0275mod=t.oAB({type:o});static#i=this.\u0275inj=t.cJS({imports:[m.ez,L,q.O,_.Tx,f.Ps,x.ZX,U.N]})}return o})()}}]);