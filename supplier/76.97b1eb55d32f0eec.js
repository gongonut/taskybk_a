"use strict";(self.webpackChunktasky_supplier=self.webpackChunktasky_supplier||[]).push([[76],{8076:(N,h,r)=>{r.r(h),r.d(h,{CategListModule:()=>E});var m=r(7087),p=r(3759),_=r(3241),t=r(2283),f=r(6806),C=r(3162),v=r(1359),y=r(8937),b=r(3578),u=r(9347),x=r(8464);function w(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"div",41)(1,"div",42)(2,"div",43),t._uU(3),t.qZA(),t.TgZ(4,"div",44),t._uU(5),t.qZA(),t.TgZ(6,"mat-icon",45),t.NdJ("click",function(){const s=t.CHM(e).index,n=t.oxw().index,c=t.oxw(3).$implicit,d=t.oxw();return t.KtG(d.addEditElementItem(c,n,s))}),t._uU(7,"edit"),t.qZA(),t.TgZ(8,"mat-icon",46),t.NdJ("click",function(){const s=t.CHM(e).index,n=t.oxw().index,c=t.oxw(3).$implicit,d=t.oxw();return t.KtG(d.deleteCharactItem(c,n,s))}),t._uU(9,"delete"),t.qZA()()()}if(2&o){const e=l.$implicit;t.xp6(3),t.Oqu(e.title),t.xp6(2),t.Oqu(e.selectType)}}function k(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"div",32)(1,"div",33)(2,"div",34)(3,"div",35)(4,"div",36),t._uU(5),t.qZA(),t.TgZ(6,"mat-icon",37),t.NdJ("click",function(){const s=t.CHM(e).index,n=t.oxw(3).$implicit,c=t.oxw();return t.KtG(c.addEditCharactHeader(n,s))}),t._uU(7,"edit"),t.qZA(),t.TgZ(8,"mat-icon",23),t.NdJ("click",function(){const s=t.CHM(e).index,n=t.oxw(3).$implicit,c=t.oxw();return t.KtG(c.deleteHeader(n,s))}),t._uU(9,"delete"),t.qZA()(),t.TgZ(10,"div",38)(11,"div",39),t._uU(12,"Elementos"),t.qZA(),t.TgZ(13,"div")(14,"mat-icon",23),t.NdJ("click",function(){const s=t.CHM(e).index,n=t.oxw(3).$implicit,c=t.oxw();return t.KtG(c.addEditElementItem(n,s,-1))}),t._uU(15,"add"),t.qZA()()()(),t.YNc(16,w,10,2,"div",40),t.qZA()()}if(2&o){const e=l.$implicit;t.xp6(5),t.Oqu(e.header),t.xp6(11),t.Q6J("ngForOf",e.data)}}function Z(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"div",27),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2).$implicit,s=t.oxw();return t.KtG(s.addEditCharactHeader(a,-1))}),t.TgZ(2,"div",28),t._uU(3,"Caracter\xedsticas"),t.qZA(),t._uU(4," \xa0 "),t.TgZ(5,"mat-icon",29),t._uU(6,"add"),t.qZA()(),t.TgZ(7,"div",30),t.YNc(8,k,17,2,"div",31),t.qZA()()}if(2&o){const e=t.oxw(2).$implicit;t.xp6(8),t.Q6J("ngForOf",e.characterList)}}function T(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"div",13)(1,"div",14)(2,"div",15),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(),s=a.$implicit,n=a.index,c=t.oxw();return t.KtG(c.addEditCategory(s,n))}),t._UZ(3,"img",16),t.qZA(),t.TgZ(4,"div",17),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(),s=a.$implicit,n=a.index,c=t.oxw();return t.KtG(c.addEditCategory(s,n))}),t.TgZ(5,"div",18)(6,"mat-icon",19),t._uU(7),t.qZA(),t.TgZ(8,"div",20),t._uU(9),t.qZA()(),t.TgZ(10,"div",21),t._uU(11),t.qZA()()(),t.TgZ(12,"div",22)(13,"mat-icon",23),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(),s=a.$implicit,n=a.index,c=t.oxw();return t.KtG(c.addEditCategory(s,n))}),t._uU(14,"edit"),t.qZA(),t.TgZ(15,"mat-icon",23),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().index,s=t.oxw();return t.KtG(s.switchSubView(a))}),t._uU(16,"expand_more"),t.qZA(),t._uU(17," \xa0 "),t.TgZ(18,"mat-icon",24),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().index,s=t.oxw();return t.KtG(s.deleteCategory(a))}),t._uU(19,"delete"),t.qZA(),t.TgZ(20,"mat-icon",25),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,s=t.oxw();return t.KtG(s.categLevel(a,1))}),t._uU(21,"chevron_right"),t.qZA()(),t.YNc(22,Z,9,1,"div",26),t.qZA()}if(2&o){const e=t.oxw(),i=e.$implicit,a=e.index,s=t.oxw();t.xp6(3),t.Q6J("src",s.getCategImage(i),t.LSH),t.xp6(4),t.Oqu(s.getCategVisible(i.visible)),t.xp6(2),t.Oqu(i.name),t.xp6(2),t.Oqu(i.description),t.xp6(11),t.Q6J("ngIf",s.getSubView(a))}}function L(o,l){if(1&o&&(t.TgZ(0,"div"),t.YNc(1,T,23,5,"div",12),t.qZA()),2&o){const e=l.$implicit,i=t.oxw();t.xp6(1),t.Q6J("ngIf",i.getCateg2Show(e))}}const A=[{path:"",component:(()=>{class o{constructor(e,i,a,s){this.dtb=e,this.dg=i,this.snkBar=a,this.sanitizer=s,this.categ_list=[],this.subView=-1,this.categShow=[{_id:"root",title:"Raiz"}],this.categorySchema={controls:[{name:"_id",label:"C\xf3digo:",type:"text",style:"w-full",disabled:!0,validators:{required:!0}},{name:"name",label:"Nombre de la categor\xeda:",type:"text",style:"w-full",validators:{required:!0}},{name:"description",label:"Descripci\xf3n:",type:"textarea",style:"w-full",totalRows:2,validators:{}},{name:"visible",label:"Visible",type:"checkbox",validators:{}},{name:"indexCategory",label:"Viene de...",type:"multiselect",style:"w-full",selectOptions:[],validators:{}}]},this.characteristic={controls:[{name:"header",label:"T\xedtulo:",type:"text",style:"w-full",validators:{required:!0}},{name:"duplicable",label:"Duplicable",type:"checkbox",validators:{}}]},this.CharactItem={controls:[{name:"title",label:"T\xedtulo del elemento:",type:"text",style:"w-full",validators:{required:!0}},{name:"type",label:"Tipo de campo:",type:"select",selectOptions:[{key:"text",value:"Texto"},{key:"number",value:"N\xfamero"},{key:"picture",value:"Foto/Imagen - v\xednculo"},{key:"checkbox",value:"si/no"},{key:"link",value:"V\xednculo"}],style:"w-72",validators:{required:!0}},{name:"add2filter",label:"Agregar a los filtros de b\xfasqueda",type:"checkbox",validators:{required:!0}},{name:"selectType",label:"Tipo de selector:",type:"select",selectOptions:[{key:"none",value:"Ninguno"},{key:"checkbox",value:"si/no"},{key:"select",value:"Lista de selecci\xf3n"},{key:"multiselect",value:"Lista de selecci\xf3n m\xfatiples"},{key:"select-images",value:"Lista de selecci\xf3n (v\xednculos)"}],style:"w-72",validators:{required:!0}}]}}ngOnInit(){var e=this;return(0,_.Z)(function*(){e.getCategories()})()}getCategories(){var e=this;return(0,_.Z)(function*(){e.categ_list=(yield e.dtb.getAllCategAsync())||[],e.categShow=[{_id:"root",title:"Raiz"}],e.categ_list.sort((i,a)=>i.name.toLowerCase()<a.name.toLowerCase()?-1:1)})()}getClicked(e){var i=this;return(0,_.Z)(function*(){switch(e.index){case 1:case 3:break;case 2:i.addEditCategory(null,-1);break;case 4:yield i.getCategories()}})()}getCateg2Show(e){return!!(1===this.categShow.length&&0===e.indexCategory.length||e.indexCategory?.includes(this.categShow[this.categShow.length-1]._id))}categLevel(e,i){var a=this;return(0,_.Z)(function*(){if(-1===i&&a.categShow.length>1)a.categShow.splice(a.categShow.length-1,1);else{if(null===e)return yield a.getCategories();a.categShow.push({_id:e._id,title:e.name})}})()}getCategVisible(e){return e?"visibility":"visibility_off"}addEditCategory(e,i=-1){let a=-1===i;if(a){let c="C000";this.categ_list.length>0&&(c=this.dtb.nextConsecutive("C",3,!0,this.categ_list[this.categ_list.length-1]._id)),e={_id:c,name:"",characterList:[],visible:!0,indexCategory:[]},this.categShow.length>1&&e.indexCategory?.push(this.categShow[this.categShow.length-1]._id)}const s=[];if(this.categ_list.forEach(c=>{e._id!==c._id&&s.push({key:c._id,value:c.name})}),s.length>0&&this.categorySchema.controls){const c=this.categorySchema.controls.find(d=>"indexCategory"===d.name);c&&(c.selectOptions=s)}let n={schema:this.categorySchema,value:e,title:"Categor\xeda",showImage:!0,image:e.picture,imgwidth:400,imgheight:400,dgheigth:700};this.dg.aDefault(n).subscribe(c=>{c&&(delete c._propName_,delete c._valid_,this.dg.updatePropResult(e,c),n.image&&e&&(e.picture=n.image),a?this.categ_list.push(e):this.categ_list[i]=e,this.dtb.setCategory(e,a))})}deleteCategory(e){this.snkBar.open("Eliminar "+this.categ_list[e].name,"Ok",{duration:7e3}).onAction().subscribe(i=>{this.dtb.deleteCategory(this.categ_list[e]._id),this.categ_list.splice(e,1)})}addEditCharactHeader(e,i){let a=!1,s=e.characterList[i];-1===i&&(s={id:this.dtb.getSerialKey(2,4),header:"",duplicable:!1,data:[]},a=!0),this.dg.aDefault({schema:this.characteristic,value:s,title:"T\xedtulo de la caracter\xedstica",dgheigth:265}).subscribe(c=>{c&&(delete c._propName_,delete c._valid_,this.dg.updatePropResult(s,c),a?e.characterList.push(s):e.characterList[i]=s,this.dtb.setCategory(e,!1))})}deleteHeader(e,i){const a=e.characterList[i];a&&this.snkBar.open("Eliminar "+a.header,"Ok",{duration:7e3}).onAction().subscribe(s=>{e.characterList.splice(i,1),this.dtb.setCategory(e,!1)})}addEditElementItem(e,i,a){let s=!0,c={id:this.dtb.getSerialKey(2,4),title:"",type:"",selectType:"",add2filter:!1,selectlist:[]};a>=0&&e.characterList[i].data[a]&&(c=e.characterList[i].data[a],s=!1),this.dg.aDefault({schema:this.CharactItem,value:c,title:"Datos de "+e.characterList[i].header,dgwidth:600,dgheigth:580,function:[{name:"selectable",self:this,btn_source:!0,function:this.optionEditable}]}).subscribe(g=>{g&&(delete g._propName_,delete g._valid_,this.dg.updatePropResult(c,g),s?e.characterList[i].data.push(c):e.characterList[i].data[a]=c,this.dtb.setCategory(e,!1))})}optionEditable(e,i,a){if(e.CharactItem.controls){const s=e.CharactItem.controls.findIndex(n=>"selectlist"===n.name);if(s&&s>=0)return e.CharactItem.controls[s].disabled=!i.selectable,i.selectable||(i.selectlist=""),{schema:e.CharactItem,value:i}}return""}deleteCharactItem(e,i,a){const s=e.characterList[i].data[a];s&&this.snkBar.open("Eliminar "+s.title,"Ok",{duration:7e3}).onAction().subscribe(n=>{e.characterList[i].data.splice(a,1),this.dtb.setCategory(e,!1)})}switchSubView(e){this.subView=this.subView===e?-1:e}getSubView(e){return this.subView===e}getCategImage(e){return e.picture?this.sanitizer.bypassSecurityTrustUrl(e.picture):""}fileChangeEvent(e,i=null){}static#t=this.\u0275fac=function(i){return new(i||o)(t.Y36(f.k),t.Y36(C.x),t.Y36(v.ux),t.Y36(y.H7))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-categ-list"]],decls:26,vars:5,consts:[[1,"flex","flex-col","max-h-screen"],[3,"buttons","nav_menu","onClicked"],["id","spanTrigger",3,"matMenuTriggerFor"],["editControlTrigger","matMenuTrigger"],[1,"flex-1","px-1","pt-1","bg-gray-200","overflow-auto"],[1,"flex","text-sky-500","mb-2",3,"click"],[4,"ngFor","ngForOf"],["products","matMenu"],[1,"font-medium"],["color","primary"],["color","primary",1,"mt-1"],["mat-menu-item",""],["class","p-1 flex flex-col bg-white border border-gray-500 mb-2",4,"ngIf"],[1,"p-1","flex","flex-col","bg-white","border","border-gray-500","mb-2"],[1,"flex","justify-start"],[1,"w-30",3,"click"],[1,"h-32","w-28","border","border-gray-400","py-1","px-1","rounded","shadow-sm",3,"src"],[1,"grow","ml-2","flex","flex-col",3,"click"],[1,"flex","justify-start","font-medium","font-medium"],[1,"text-gray-800"],[1,"ml-2"],[1,"mt-1","font-thin","text-sm"],[1,"mt-1","flex","justify-end","text-gray-300","bg-gray-200"],[1,"hover:text-sky-500",3,"click"],[1,"hover:text-red-500",3,"click"],[1,"ml-12","text-sky-500",3,"click"],[4,"ngIf"],[1,"mt-2","flex","px-1","text-sm","bg-gray-200","hover:text-sky-500",3,"click"],[1,"font-medium","text-gray-400","mt-1"],[1,"w-20","text-gray-300","hover:text-sky-500"],[1,"flex","flex-col","mx-2","mt-1","text-sm"],["class","mt-2",4,"ngFor","ngForOf"],[1,"mt-2"],[1,"border","border-gray-300"],[1,"flex","flex-row","align-middle"],[1,"grow","flex","flex-row","items-center","justify-center","text-gray-300"],[1,"text-center","font-medium","text-black"],[1,"w-20","ml-1","hover:text-sky-500",3,"click"],[1,"w-20","flex","flex-row","items-end","justify-end","align-middle","font-medium","text-sm","text-gray-300","w-40"],[1,"text-gray-400"],["class","flex flex-col",4,"ngFor","ngForOf"],[1,"flex","flex-col"],[1,"flex","justify-items-start","align-middle","divide-y","divide-x","divide-gray-300"],[1,"w-1/2","px-1","font-medium","text-sm","text-gray-800"],[1,"w-1/2","px-1","text-sm","bg-white"],[1,"text-gray-300","hover:text-sky-500",3,"click"],[1,"text-gray-300","hover:text-red-500",3,"click"]],template:function(i,a){if(1&i&&(t.TgZ(0,"div",0)(1,"app-header",1),t.NdJ("onClicked",function(n){return a.getClicked(n)}),t.qZA(),t._UZ(2,"span",2,3),t.TgZ(4,"div",4)(5,"div",5),t.NdJ("click",function(){return a.categLevel(null,-1)}),t.TgZ(6,"mat-icon"),t._uU(7,"chevron_left"),t.qZA(),t.TgZ(8,"div"),t._uU(9),t.qZA()(),t.YNc(10,L,2,1,"div",6),t.qZA(),t.TgZ(11,"mat-menu",null,7)(13,"div",8)(14,"mat-icon",9),t._uU(15,"cloud_upload"),t.qZA(),t._uU(16," Base remota "),t.qZA(),t._UZ(17,"hr"),t.TgZ(18,"div",8)(19,"mat-icon",10),t._uU(20,"edit"),t.qZA(),t._uU(21," Base local "),t.qZA(),t.TgZ(22,"button",11),t._uU(23," Data base hacia Excel "),t.qZA(),t.TgZ(24,"button",11),t._uU(25," Lista de im\xe1genes en la base "),t.qZA()()()),2&i){const s=t.MAs(12);t.xp6(1),t.Q6J("buttons","111111")("nav_menu",!1),t.xp6(1),t.Q6J("matMenuTriggerFor",s),t.xp6(7),t.Oqu(a.categShow[a.categShow.length-1].title),t.xp6(1),t.Q6J("ngForOf",a.categ_list)}},dependencies:[m.sg,m.O5,b.G,u.VK,u.OP,u.p6,x.Hw]})}return o})()}];let q=(()=>{class o{static#t=this.\u0275fac=function(i){return new(i||o)};static#e=this.\u0275mod=t.oAB({type:o});static#i=this.\u0275inj=t.cJS({imports:[p.Bz.forChild(A),p.Bz]})}return o})();var U=r(769),S=r(7572);let E=(()=>{class o{static#t=this.\u0275fac=function(i){return new(i||o)};static#e=this.\u0275mod=t.oAB({type:o});static#i=this.\u0275inj=t.cJS({imports:[m.ez,q,U.O,u.Tx,x.Ps,v.ZX,S.N]})}return o})()}}]);