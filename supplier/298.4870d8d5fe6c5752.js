"use strict";(self.webpackChunktasky_supplier=self.webpackChunktasky_supplier||[]).push([[298],{2298:(St,K,c)=>{c.r(K),c.d(K,{ActivityReportModule:()=>xt});var C=c(7087),b=c(3759),T=c(3241),t=c(2283),Y=c(4758),be=c(6806),Ce=c(3638),De=c(1682),Re=c(3620),ve=c(3578),O=c(9347),ee=c(8464),te=c(6410);const xe=["spreadsheet"];let oe=(()=>{class o{constructor(e){this.sharedvar=e,this.data=[],this.headerTitle=[],this.title="CodeSandbox",this.displayedColumns=[],this.columnsToDisplay=[]}ngOnChanges(e){this.buildTable()}buildTable(){this.headerTitle=[];for(let e of this.header.keys())this.headerTitle.push(e);console.log(this.data),console.log(this.header),this.displayedColumns=this.headerTitle,this.columnsToDisplay=this.displayedColumns.slice()}getData(e,a){switch(this.header.get(e)){case"datetime-local":return this.sharedvar.formatNumber2DateTime(a[e],"/");case"date":return this.sharedvar.formatNumber2Date(a[e],"/");case"geolocation":return`lng: ${a[e].lng}, lat: ${a[e].lat}`;case"array":return a[e]?a[e].toString():""}return a[e]}static#e=this.\u0275fac=function(a){return new(a||o)(t.Y36(Y.D))};static#t=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-table"]],viewQuery:function(a,i){if(1&a&&t.Gf(xe,5),2&a){let r;t.iGM(r=t.CRH())&&(i.spreadsheet=r.first)}},inputs:{data:"data",header:"header"},features:[t.TTD],decls:0,vars:0,template:function(a,i){}})}return o})();var z=c(3279);const ke=["chart"];function Se(o,n){if(1&o&&(t.TgZ(0,"div",1),t._UZ(1,"apx-chart",2),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("series",e.chartOptions.series)("chart",e.chartOptions.chart)("dataLabels",e.chartOptions.dataLabels)("plotOptions",e.chartOptions.plotOptions)("yaxis",e.chartOptions.yaxis)("legend",e.chartOptions.legend)("fill",e.chartOptions.fill)("stroke",e.chartOptions.stroke)("tooltip",e.chartOptions.tooltip)("xaxis",e.chartOptions.xaxis)}}let ae=(()=>{class o{constructor(e){this.sharedvar=e,this.data=[],this.category="_id",this.target="_id",this.chunk=0,this.onSelect=new t.vpe,this.chunkSize=0,this.sliceChunk=[],this.chartOptions={series:[{name:"Net Profit",data:[44,55,57,56,61,58,63,60,66]},{name:"Revenue",data:[76,85,101,98,87,105,91,114,94]},{name:"Free Cash Flow",data:[35,41,36,26,45,48,52,53,41]}],chart:{type:"bar",height:350},plotOptions:{bar:{horizontal:!1,columnWidth:"55%"}},dataLabels:{enabled:!1},stroke:{show:!0,width:2,colors:["transparent"]},xaxis:{categories:["Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct"]},yaxis:{title:{text:"$ (thousands)"}},fill:{opacity:1},tooltip:{y:{formatter:function(a){return"$ "+a+" thousands"}}}}}static#e=this.\u0275fac=function(a){return new(a||o)(t.Y36(Y.D))};static#t=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-column"]],viewQuery:function(a,i){if(1&a&&t.Gf(ke,5),2&a){let r;t.iGM(r=t.CRH())&&(i.chart=r.first)}},inputs:{data:"data",header:"header",category:"category",target:"target",chunk:"chunk"},outputs:{onSelect:"onSelect"},decls:1,vars:1,consts:[["id","chart",4,"ngIf"],["id","chart"],[3,"series","chart","dataLabels","plotOptions","yaxis","legend","fill","stroke","tooltip","xaxis"]],template:function(a,i){1&a&&t.YNc(0,Se,2,10,"div",0),2&a&&t.Q6J("ngIf",i.data&&i.data.length>0)},dependencies:[C.O5,z.x]})}return o})();const Me=["editControlTrigger"];function Te(o,n){if(1&o&&t._UZ(0,"app-table",19),2&o){const e=t.oxw();t.Q6J("data",e.dataList)("header",e.filterHeader)}}function Oe(o,n){if(1&o&&t._UZ(0,"app-column",20),2&o){const e=t.oxw();t.Q6J("data",e.dataList)}}function Fe(o,n){1&o&&(t.TgZ(0,"mat-icon"),t._uU(1,"Porcentajes"),t.qZA())}const Ee=[{path:"",component:(()=>{class o{constructor(e,a,i,r,s,l){this.sharedvar=e,this.dtb=a,this.dg=i,this.data2excel=r,this.ds=s,this.route=l,this.header={},this.filterHeader=new Map,this.yAxis="_id",this.xAxis="_id",this.chunk="D",this.windType="T"}ngOnInit(){var e=this;return(0,T.Z)(function*(){e.sub=e.route.params.subscribe(function(){var a=(0,T.Z)(function*(i){const r=new Date,s=r.setHours(0,0,0,0),l=r.setHours(23,59,59,999);e.localFilter={crm:"F",staff__id:[],pollGrpData:i.id,costumers:[],products:[],products_name_sel:[],date_all:!1,date_ini:s,date_end:l},e.filterDialog()});return function(i){return a.apply(this,arguments)}}())})()}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}getTitleText(){return"header titulo"}getClicked(e){switch(e.index){case 1:this.filterDialog();break;case 3:let a=document.getElementById("spanTrigger");a&&(a.style.display="",a.style.position="absolute",a.style.left=e.pageX+5+"px",a.style.top=e.pageY+5+"px",this.editControlTrigger.openMenu())}}filterDialog(){var e=this;return(0,T.Z)(function*(){e.sharedvar.wait=!0;let a=[],i=[];(yield e.dtb.getStaffByFilterAsync({queryType:3,active:!0,stars:0,rol:"K"})).forEach(f=>{a.push({key:f._id,value:`${f.names||f.email} ${f.lastnames||""}`})}),(yield e.dtb.getPollGrpActiveAsync()).forEach(f=>{"index"!==f.id&&i.push({key:f._id,value:f.name})}),e.dg.aDefault({schema:{controls:[{name:"pollGrpData",label:"Formulario:",type:"select",style:"w-full",disabled:!0,validators:{required:!0},selectOptions:i},{name:"staff__id",label:"Taskers:",type:"multiselect",style:"w-full",placeholder:"Asignados a \xe9sta formulario",validators:{},selectOptions:a},{name:"date_ini",label:"Fecha inicio:",type:"date",validators:{}},{name:"date_end",label:"Fecha final:",type:"date",validators:{}}]},title:"Filtros",dgheigth:500,dgwidth:550,value:e.localFilter}).subscribe(function(){var f=(0,T.Z)(function*(d){if(e.sharedvar.wait=!1,d){if(d.alldates)d.date_ini=0,d.date_end=0;else{let h=new Date(d.date_ini);d.date_ini=h.setHours(0,0,0,0),h=new Date(d.date_end),d.date_end=h.setHours(23,59,59,999)}e.localFilter={crm:"F",staff__id:d.staff__id,pollGrpData:d.pollGrpData,costumers:d.costumers,products:d.products,date_all:!1,date_ini:d.date_ini,date_end:d.date_end,products_name_sel:[]},yield e.dtb.getPollGrpAnaliticAsync(e.localFilter).then(h=>{e.dataList=h.data,e.header=h.header,e.filterHeader=new Map(Object.entries(h.header))})}});return function(d){return f.apply(this,arguments)}}())})()}getXYAxis(e){this.onExportexcel()}setChunk(){}changeWindType(e){this.windType=e||"T"}onExportexcel(){const e=`Reporte Actividad fechas ${this.sharedvar.formatNumber2Date(this.localFilter.date_ini||0,"-")} - \n    ${this.sharedvar.formatNumber2Date(this.localFilter.date_end||0,"-")}`;this.data2excel.excelExport(this.dataList,e,"Actividad",this.header,[])}static#e=this.\u0275fac=function(a){return new(a||o)(t.Y36(Y.D),t.Y36(be.k),t.Y36(Ce.x),t.Y36(De.Z),t.Y36(Re.n),t.Y36(b.gz))};static#t=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-activity-report"]],viewQuery:function(a,i){if(1&a&&t.Gf(Me,5),2&a){let r;t.iGM(r=t.CRH())&&(i.editControlTrigger=r.first)}},decls:47,vars:8,consts:[[1,"flex","flex-col","max-h-screen"],[3,"buttons","nav_menu","bar_text","onClicked"],["id","spanTrigger",3,"matMenuTriggerFor"],["editControlTrigger","matMenuTrigger"],[1,"flex-1","m-2","bg-gray-100","overflow-scroll"],[1,"border","border-gray-200","rounded-sm","shadow-lg"],["class","h-96",3,"data","header",4,"ngIf"],[3,"data",4,"ngIf"],[1,"align-middle","justify-end"],["color","primary","mat-flat-button","",3,"click"],["color","warn","mat-flat-button","",3,"click"],["controlEdit","matMenu"],["mat-menu-item","",3,"click"],["color","primary"],[4,"ngIf"],[1,"mt-1","text-violet-500","text-lg","font-medium"],["mat-menu-item",""],[1,"ml-1","mt-1","text-violet-500","text-lg","font-medium"],[1,"ml-3"],[1,"h-96",3,"data","header"],[3,"data"]],template:function(a,i){if(1&a&&(t.TgZ(0,"div",0)(1,"app-header",1),t.NdJ("onClicked",function(s){return i.getClicked(s)}),t.qZA(),t._UZ(2,"span",2,3),t.TgZ(4,"div",4)(5,"div",5),t.YNc(6,Te,1,2,"app-table",6),t.YNc(7,Oe,1,1,"app-column",7),t.qZA()(),t.TgZ(8,"div",8)(9,"button",9),t.NdJ("click",function(){return i.changeWindType("T")}),t.TgZ(10,"span"),t._uU(11,"Tabla"),t.qZA()(),t._uU(12," \xa0 "),t.TgZ(13,"button",10),t.NdJ("click",function(){return i.changeWindType("G")}),t.TgZ(14,"span"),t._uU(15,"Gr\xe1fica"),t.qZA()()()(),t.TgZ(16,"mat-menu",null,11)(18,"button",12),t.NdJ("click",function(){return i.getXYAxis("X")}),t.TgZ(19,"mat-icon",13),t._uU(20,"trending_up"),t.qZA(),t._uU(21),t.qZA(),t.TgZ(22,"button",12),t.NdJ("click",function(){return i.getXYAxis("E")}),t.TgZ(23,"mat-icon",13),t._uU(24,"trending_up"),t.qZA(),t._uU(25," Elementos de la gr\xe1fica "),t.qZA(),t.TgZ(26,"button",12),t.NdJ("click",function(){return i.setChunk()}),t.YNc(27,Fe,2,0,"mat-icon",14),t._uU(28," trozos del eje X "),t.qZA(),t._UZ(29,"hr"),t.TgZ(30,"h2",15)(31,"mat-icon"),t._uU(32,"trending_up"),t.qZA(),t._uU(33,"\xa0Inteligencia Artificial "),t.qZA(),t.TgZ(34,"div")(35,"button",16),t._uU(36," An\xe1lisis con soporte de IA "),t.qZA()(),t._UZ(37,"hr"),t.TgZ(38,"h2",17)(39,"mat-icon"),t._uU(40,"file_download"),t.qZA(),t._uU(41,"\xa0Exportar"),t.qZA(),t.TgZ(42,"div",18)(43,"button",12),t.NdJ("click",function(){return i.getXYAxis("L")}),t._uU(44," Exportar Informe a Excel. "),t.qZA(),t.TgZ(45,"button",16),t._uU(46," Enviar Informe a Google Spread Sheet "),t.qZA()()()),2&a){const r=t.MAs(17);t.xp6(1),t.Q6J("buttons","110100")("nav_menu",!1)("bar_text",i.getTitleText()),t.xp6(1),t.Q6J("matMenuTriggerFor",r),t.xp6(4),t.Q6J("ngIf","T"===i.windType),t.xp6(1),t.Q6J("ngIf","G"===i.windType),t.xp6(14),t.hij(" Categor\xeda: ",i.xAxis," "),t.xp6(6),t.Q6J("ngIf","D"===i.chunk)}},dependencies:[C.O5,ve.G,O.VK,O.OP,O.p6,ee.Hw,te.lW,oe,ae]})}return o})()}];let Ae=(()=>{class o{static#e=this.\u0275fac=function(a){return new(a||o)};static#t=this.\u0275mod=t.oAB({type:o});static#o=this.\u0275inj=t.cJS({imports:[b.Bz.forChild(Ee),b.Bz]})}return o})();var Ne=c(769),He=c(1359),ne=(c(8318),c(4912),c(1833),c(878),c(8707));c(4053),c(1066),c(2029),c(19),c(3296),c(8138),c(3236);let et=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[ne.Cl]}),o})();var fe=c(5061);let gt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[fe.BQ,et,fe.BQ]}),o})();const yt=[{path:"",component:oe}];let bt=(()=>{class o{static#e=this.\u0275fac=function(a){return new(a||o)};static#t=this.\u0275mod=t.oAB({type:o});static#o=this.\u0275inj=t.cJS({imports:[b.Bz.forChild(yt),b.Bz]})}return o})(),Ct=(()=>{class o{static#e=this.\u0275fac=function(a){return new(a||o)};static#t=this.\u0275mod=t.oAB({type:o});static#o=this.\u0275inj=t.cJS({imports:[C.ez,bt,gt]})}return o})();const Dt=[{path:"",component:ae}];let Rt=(()=>{class o{static#e=this.\u0275fac=function(a){return new(a||o)};static#t=this.\u0275mod=t.oAB({type:o});static#o=this.\u0275inj=t.cJS({imports:[b.Bz.forChild(Dt),b.Bz]})}return o})(),vt=(()=>{class o{static#e=this.\u0275fac=function(a){return new(a||o)};static#t=this.\u0275mod=t.oAB({type:o});static#o=this.\u0275inj=t.cJS({imports:[C.ez,Rt,z.X]})}return o})(),xt=(()=>{class o{static#e=this.\u0275fac=function(a){return new(a||o)};static#t=this.\u0275mod=t.oAB({type:o});static#o=this.\u0275inj=t.cJS({imports:[C.ez,Ae,Ne.O,He.ZX,z.X,O.Tx,ee.Ps,te.ot,Ct,vt]})}return o})()}}]);