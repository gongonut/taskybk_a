"use strict";(self.webpackChunktasky_tasker=self.webpackChunktasky_tasker||[]).push([[559],{6559:(k,C,d)=>{d.r(C),d.d(C,{PollModule:()=>Pe});var f=d(214),u=d(6870),c=d(3241),R=d(2507),w=d(8403);class E extends Error{constructor(){super("Request was cancelled"),this.name="CancelError"}get isCanceled(){return!0}}class T extends Error{constructor(h){super("Could not get the public IP address",h),this.name="IpNotFoundError"}}const p={timeout:5e3},B={v4:["https://ipv4.icanhazip.com/","https://api.ipify.org/"],v6:["https://ipv6.icanhazip.com/","https://api6.ipify.org/"]},I=(n,h,e)=>{const s=new XMLHttpRequest;let l;const i=new Promise((o,a)=>{l=a,s.addEventListener("error",a,{once:!0}),s.addEventListener("timeout",a,{once:!0}),s.addEventListener("load",()=>{const r=s.responseText.trim();r&&w[e](r)?o(r):a()},{once:!0}),s.open("GET",n),s.timeout=h.timeout,s.send()});return i.cancel=()=>{s.abort(),l(new E)},i},F=(n,h)=>{let e;const s=(0,c.Z)(function*(){const l=[...B[n],...h.fallbackUrls??[]];let i;for(const o of l)try{return e=I(o,h,n),yield e}catch(a){if(i=a,a instanceof E)throw a}throw new T({cause:i})})();return s.cancel=()=>{e.cancel()},s},V={v4:n=>F("v4",{...p,...n}),v6:n=>F("v6",{...p,...n})};function Z(){return(Z=(0,c.Z)(function*(n){if(n={timeout:5e3,ipVersion:4,...n},!navigator?.onLine)return!1;const h=4===n.ipVersion?"v4":"v6";try{return yield V[h](n),!0}catch{return!1}})).apply(this,arguments)}var t=d(6637),N=d(9104),A=d(6090),O=d(3832),L=d(7612),D=d(1833),M=d(6213),P=d(8861),S=d(4999);function Y(n,h){if(1&n){const e=t.EpF();t.TgZ(0,"div",15)(1,"input",16),t.NdJ("change",function(){t.CHM(e);const l=t.oxw(2);return t.KtG(l.onChekAll())}),t.qZA()()}if(2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("checked",e.chekAll)}}function q(n,h){if(1&n){const e=t.EpF();t.TgZ(0,"div",11),t.YNc(1,Y,2,1,"div",12),t.TgZ(2,"mat-icon",13),t._uU(3),t.qZA(),t.TgZ(4,"input",14),t.NdJ("ngModelChange",function(l){t.CHM(e);const i=t.oxw();return t.KtG(i.filtertext=l)})("change",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.onViewSelected(!1))}),t.qZA()()}if(2&n){const e=t.oxw(),s=t.MAs(15);t.xp6(1),t.Q6J("ngIf",e.multiSelect),t.xp6(1),t.Q6J("matMenuTriggerFor",s),t.xp6(1),t.Oqu(e.getView()),t.xp6(1),t.Q6J("ngModel",e.filtertext)}}function Q(n,h){1&n&&(t.TgZ(0,"mat-icon",23),t._uU(1,"edit"),t.qZA())}function z(n,h){1&n&&(t.TgZ(0,"mat-icon",23),t._uU(1,"delete_outline"),t.qZA())}function H(n,h){if(1&n){const e=t.EpF();t.TgZ(0,"div",19)(1,"input",20),t.NdJ("ngModelChange",function(l){t.CHM(e);const i=t.oxw().$implicit;return t.KtG(i.selected=l)})("change",function(){t.CHM(e);const l=t.oxw().$implicit,i=t.oxw();return t.KtG(i.onSelected(l))}),t.qZA(),t.TgZ(2,"label",21),t._uU(3),t.qZA(),t.YNc(4,Q,2,0,"mat-icon",22),t.YNc(5,z,2,0,"mat-icon",22),t.qZA()}if(2&n){const e=t.oxw().$implicit,s=t.oxw();t.xp6(1),t.Q6J("ngModel",e.selected),t.xp6(2),t.Oqu(e.name),t.xp6(1),t.Q6J("ngIf",!0===s.viewEdit),t.xp6(1),t.Q6J("ngIf",!0===s.viewDel)}}function j(n,h){if(1&n&&(t.TgZ(0,"div",17),t.YNc(1,H,6,4,"div",18),t.qZA()),2&n){const e=h.$implicit,s=t.oxw();t.xp6(1),t.Q6J("ngIf",s.getViewFilter(e))}}function K(n,h){if(1&n){const e=t.EpF();t.TgZ(0,"div",24)(1,"button",7),t.NdJ("click",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.onNew())}),t._uU(2," Nuevo\xa0 "),t.TgZ(3,"mat-icon"),t._uU(4,"add"),t.qZA()()()}}let W=(()=>{class n{constructor(e,s){this.dialogRef=e,this.data=s,this.filtertext="",this.selectedOptions=[],this.chekAll=!1,this.viewSelected=!1,this.multiSelect=!1,this.viewEdit=!1,this.viewDel=!1,e.disableClose=!0,this.multiSelect=s.multiSelect||!1,this.viewEdit=s.viewEdit||!1,this.viewDel=s.viewDel||!1}onNew(){this.dialogRef.close({new:!0})}onChekAll(){this.chekAll=!this.chekAll,this.data.valuelst?.forEach(e=>{e.selected=this.chekAll})}getViewFilter(e){if(this.viewSelected)return e.selected||!1;const s=this.filtertext.toUpperCase();return!!(0===s.length||e&&e.name&&e.name.toUpperCase().includes(s))}onSelected(e){this.multiSelect||(this.selectedOptions=[e],this.dialogRef.close(this.selectedOptions))}onSave(){this.selectedOptions=[],this.data.valuelst?.forEach(e=>{e.selected&&this.selectedOptions.push(e)}),this.dialogRef.close(this.selectedOptions)}onDismiss(){this.dialogRef.close()}getView(){return this.viewSelected?"done":"visibility"}onViewSelected(e){this.viewSelected=e}static#e=this.\u0275fac=function(s){return new(s||n)(t.Y36(L.so),t.Y36(L.WI))};static#t=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-select-dialog"]],decls:24,vars:4,consts:[[1,"flex","flex-col","h-full"],[1,"h-12","p-3","text-2xl","bg-violet-600","text-white"],["class","h-10 w-full flex flex-row items-center border-b border-violet-500",4,"ngIf"],[1,"flex-1","overflow-auto","mt-2"],["class","flex flex-column",4,"ngFor","ngForOf"],[1,"flex","p-3","justify-end","border-t","border-violet-500"],["class","flex-1","fxFlex","",4,"ngIf"],["mat-stroked-button","","color","warn",3,"click"],["mat-stroked-button","","color","primary","cdkFocusInitia","",3,"click"],["selectView","matMenu"],["mat-menu-item","",3,"click"],[1,"h-10","w-full","flex","flex-row","items-center","border-b","border-violet-500"],["class","w-6 ml-2 mt-2",4,"ngIf"],[1,"bg-gray-200","rounded-sm",3,"matMenuTriggerFor"],["type","search","placeholder","Filtrar...",1,"flex-1","ml-2","h-8","z-20","text-gray-900","outline-none","border-b","border-gray-200","focus:outline-none","focus:outline-none",3,"ngModel","ngModelChange","change"],[1,"w-6","ml-2","mt-2"],["type","checkbox",1,"w-4","h-4","focus:border-blue-500",3,"checked","change"],[1,"flex","flex-column"],["class","flex flex-row h-8 ml-2 text-sm",4,"ngIf"],[1,"flex","flex-row","h-8","ml-2","text-sm"],["id","itemsel","type","checkbox",1,"w-4","h-4","text-violet-500","bg-gray-100","border-gray-300","rounded","dark:focus:ring-violet-500","dark:ring-offset-gray-800","focus:ring-2","dark:bg-gray-700","dark:border-gray-600",3,"ngModel","ngModelChange","change"],["for","itemsel",1,"ml-4","h-4","w-72","text-sm","text-gray-900","overflow-hidden"],["class","text-gray-300",4,"ngIf"],[1,"text-gray-300"],["fxFlex","",1,"flex-1"]],template:function(s,l){1&s&&(t.TgZ(0,"div",0)(1,"h1",1),t._uU(2),t.qZA(),t.YNc(3,q,5,4,"div",2),t.TgZ(4,"div",3),t.YNc(5,j,2,1,"div",4),t.qZA(),t.TgZ(6,"div",5),t.YNc(7,K,5,0,"div",6),t.TgZ(8,"button",7),t.NdJ("click",function(){return l.onDismiss()}),t.TgZ(9,"mat-icon"),t._uU(10,"close"),t.qZA()(),t.TgZ(11,"button",8),t.NdJ("click",function(){return l.onSave()}),t.TgZ(12,"mat-icon"),t._uU(13,"done"),t.qZA()()(),t.TgZ(14,"mat-menu",null,9)(16,"button",10),t.NdJ("click",function(){return l.onViewSelected(!0)}),t.TgZ(17,"mat-icon"),t._uU(18,"done"),t.qZA(),t._uU(19," Ver seleccionados "),t.qZA(),t.TgZ(20,"button",10),t.NdJ("click",function(){return l.onViewSelected(!1)}),t.TgZ(21,"mat-icon"),t._uU(22,"visibility"),t.qZA(),t._uU(23," Ver Todo "),t.qZA()()()),2&s&&(t.xp6(2),t.Oqu(l.data.title),t.xp6(1),t.Q6J("ngIf",l.data.viewfilter),t.xp6(2),t.Q6J("ngForOf",l.data.valuelst),t.xp6(2),t.Q6J("ngIf",l.data.viewAdd))},dependencies:[f.sg,f.O5,D.lW,M.Hw,P.VK,P.OP,P.p6,S.Fj,S.Wl,S.JJ,S.On]})}return n})(),J=(()=>{class n{constructor(e){this.dialog=e}aSelectDefault(e){let s=window.innerHeight-20;return e.dgheigth=e.dgheigth||s,s=s>600?600:s,this.dialogRef=this.dialog.open(W,{panelClass:"custom-dialog-container",height:s.toString()+"px",width:"400px",data:e}),this.dialogRef.afterClosed()}static#e=this.\u0275fac=function(s){return new(s||n)(t.LFG(L.uw))};static#t=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var X=d(106),U=d(1238),ee=d(8731),te=d(5715);let le=(()=>{class n{constructor(){this.recognition=new webkitSpeechRecognition,this.isRecording=!1,this.text="",this.tempWords=""}init(){this.recognition.interimResults=!0,this.recognition.lang="es-CO",this.recognition.addEventListener("result",e=>{const s=Array.from(e.results).map(l=>l[0]).map(l=>l.transcript).join("");this.tempWords=s,console.log(this.tempWords)})}voiceRecogition(e=""){return this.isRecording?this.stop():(this.text=e,this.start()),this.text}start(){this.isRecording||(this.isRecording=!0,this.recognition.start(),console.log("Speech recognition started"),this.recognition.addEventListener("end",e=>{this.isRecording?this.wordConcat():(this.recognition.stop(),console.log("End speech recognition"))}))}stop(){this.isRecording&&(this.isRecording=!1,this.wordConcat(),this.recognition.stop(),console.log("End speech recognition"))}wordConcat(){this.text=this.text+" "+this.tempWords,this.tempWords=""}static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),se=(()=>{class n{constructor(e,s,l,i,o){this.sharedvar=e,this.dtb=s,this.snkBar=l,this.dg=i,this.ds=o,this.schemaAppoint={controls:[{name:"datetime",label:"Fecha y hora:",type:"datetime-local",validators:{required:!0}},{name:"dateend",label:"Fecha y hora final sugerida:",type:"datetime-local",sideBtn:"more_time",validators:{required:!0}},{name:"notes",label:"Notas:",type:"textarea",totalRows:4,style:"w-full",validators:{}},{name:"crm_costum_name",label:"Cliente",type:"text",sideBtn:"people",style:"w-full",validators:{}},{name:"contact",label:"Contacto",type:"text",style:"w-full",validators:{}},{name:"address",label:"Direcci\xf3n",type:"text",style:"w-full",validators:{}},{name:"geoLoc",label:"Geolocalizaci\xf3n",type:"text",style:"w-full",sideBtn:"room",validators:{}}]},this.CostumerDataSchema={controls:[{name:"name",label:"Nombre:",type:"text",style:"w-full",validators:{required:!0}},{name:"id",label:"Identificaci\xf3n:",type:"text",validators:{}},{name:"address",label:"Direcci\xf3n:",type:"textarea",style:"w-full",totalRows:5,validators:{}},{name:"email",label:"Correo elect\xf3nico:",type:"text",style:"w-full",validators:{}},{name:"linkup_1",label:"Contacto:",type:"text",style:"w-full",validators:{}},{name:"phone_1",label:"Tel\xe9fono:",type:"text",validators:{}},{name:"email_1",label:"Correo electr\xf3nico:",type:"text",style:"w-full",validators:{}}]}}onDelAppoint(e){if(this.sharedvar.staff.appoint&&0!==this.sharedvar.staff.appoint.length){if(this.sharedvar.staff.appoint[e].owner!==this.sharedvar.staff._id)return void this.snkBar.open("No est\xe1 permitido eliminar \xe9ste item?.","Ok",{duration:5e3});this.snkBar.open("Eliminar item de la agenda?.","Ok",{duration:5e3}).onAction().subscribe(s=>{this.sharedvar.staff.appoint?.splice(e,1),this.dtb.updateStaffAsync(this.sharedvar.staff)})}}onAddEditAppoint(e,s=!0){var l=this;return(0,c.Z)(function*(){const i=l.sharedvar.staff,o=[];let r="No seleccionado";if(e||(e=l.appointBasic("appoint")),l.schemaAppoint.controls){let g=l.schemaAppoint.controls.findIndex(x=>"crm_costum_name"===x.name);g>=0&&l.schemaAppoint.controls&&(l.sharedvar.selPollResult.crm_costum_id?(l.selectedCostumer=yield l.dtb.getCMRCostumAsync(l.sharedvar.selPollResult.crm_costum_id),e.address=l.selectedCostumer?.address,r=l.selectedCostumer&&l.selectedCostumer.name?l.selectedCostumer.name:r,l.selectedCostumer.linkup_1&&o.push({key:l.selectedCostumer.linkup_1,value:l.selectedCostumer.linkup_1}),l.selectedCostumer.linkup_2&&o.push({key:l.selectedCostumer.linkup_2,value:l.selectedCostumer.linkup_2}),e.crm_costum_name=r,l.schemaAppoint.controls[g].disabled=!0):l.schemaAppoint.controls[g].disabled=!1),g=l.schemaAppoint.controls.findIndex(x=>"contact"===x.name),g>=0&&l.schemaAppoint.controls&&(o.length>0?(l.schemaAppoint.controls[g].type="select",l.schemaAppoint.controls[g].selectOptions=o):l.schemaAppoint.controls[g].type="text"),g=l.schemaAppoint.controls.findIndex(x=>"geoLoc"===x.name),g>=0&&(l.schemaAppoint.controls[g].sideBtn=s?"room":"")}let m={schema:l.schemaAppoint,title:"Agenda",value:e,dgwidth:400,function:[{name:"datetime",self:l,btn_source:1,function:l.updateEndTime},{name:"dateend",self:l,btn_source:1,function:l.addTime},{name:"geoLoc",self:l,btn_source:1,function:l.geolocation}]};const v=yield(0,R.z)(l.dg.aDefault(m));return v?e.owner!==i._id?(l.snkBar.open("No est\xe1 autorizado para edita \xe9ste item?.","Ok",{duration:5e3}),null):(v.dateend<=v.datetime&&(v.dateend=v.datetime+l.sharedvar.addMinutes(30)),delete v._btnEvent_,delete v._btnclick_,delete v._propName_,delete v._valid_,delete v.staff,e.defa_values={crm_costum_id:l.selectedCostumer.id,crm_costum_name:l.selectedCostumer.name,crm_costum_contact:e.contact,crm_costum_email:e.email,crm_costum_phone:e.phone},l.dg.updatePropResult(e,v),l.selectedCostumer&&(e.contact===l.selectedCostumer.linkup_1?(e.email=l.selectedCostumer.email_1,e.phone=l.selectedCostumer.phone_1):(e.email=l.selectedCostumer.email_2,e.phone=l.selectedCostumer.phone_2)),e):null})()}geolocation(e,s,l){return(0,c.Z)(function*(){if(!s)return;(!s.geoLoc||0===s.geoLoc.length)&&(s.geoLoc=yield e.sharedvar.getLocalization());const o={title:"Geo localizaci\xf3n",dgheigth:600,value:[{_id:`${s.staff}:0`,date_ini:s.datetime,date_end:s.dateend,geoLocStart:s.geoLoc,tasker_id:s._id||"",tasker_name:s.names+" "+(s.lastnames||""),activity_id:s.pollgrp_id||"",activity_name:s.pollgrp_model_name||"No asignada",costumer_name:s.costumer||"",crm_products:[]}]},a=yield(0,R.z)(e.dg.aMap(o));return a&&(s.geoLoc=a.geoLocStart),{schema:null,value:s}})()}newCostumer(e){var s=this;return(0,c.Z)(function*(){let l={schema:s.CostumerDataSchema,title:"Datos del cliente",dgwidth:550,dgheigth:740};const i=yield(0,R.z)(e.dg.aDefault(l));return i?(delete i._valid_,delete i._btnEvent_,delete i._propName_,i.active=!0,yield e.dtb.createCostumAsync(i)):null})()}updateEndTime(e,s,l){return(0,c.Z)(function*(){if(s)return s.dateend=Number(s.datetime)+e.sharedvar.addMinutes(15),{schema:null,value:s}})()}addTime(e,s,l){return(0,c.Z)(function*(){if(s)return s.datetime=Number(s.dateend)+e.sharedvar.addMinutes(15),{schema:null,value:s}})()}onFilter(e){}appointBasic(e){return{type:e,datetime:this.sharedvar.dateNow(),dateend:this.sharedvar.dateNow(),ended:!1,owner:this.sharedvar.staff._id||"",staff_name:`${this.sharedvar.staff.names} ${this.sharedvar.staff.lastnames}`}}static#e=this.\u0275fac=function(s){return new(s||n)(t.LFG(U.D),t.LFG(N.k),t.LFG(A.ux),t.LFG(O.x),t.LFG(J))};static#t=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var oe=d(7117),ie=d(2767),ae=d(2247);const ne=["editControlTrigger"],re=["file2Trigger"],ce=["file2"],de=["maincontent"];function ue(n,h){if(1&n){const e=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.onBack())}),t.TgZ(1,"mat-icon"),t._uU(2,"arrow_back"),t.qZA()()}}function he(n,h){if(1&n){const e=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.onEndPoll())}),t._uU(1," Finalizar"),t.TgZ(2,"mat-icon"),t._uU(3,"done"),t.qZA()()}}function me(n,h){if(1&n){const e=t.EpF();t.TgZ(0,"button",25),t.NdJ("click",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.onDelete())}),t.TgZ(1,"mat-icon"),t._uU(2,"delete"),t.qZA()()}}function pe(n,h){if(1&n){const e=t.EpF();t.TgZ(0,"button",18),t.NdJ("click",function(){const i=t.CHM(e).$implicit,o=t.oxw();return t.KtG(o.visiteByAvailTitle(i))}),t._uU(1),t.qZA()}if(2&n){const e=h.$implicit,s=t.oxw();t.xp6(1),t.hij(" ",s.getAvailPollTitle(e)," ")}}function fe(n,h){if(1&n){const e=t.EpF();t.TgZ(0,"div",27)(1,"button",18),t.NdJ("click",function(){const i=t.CHM(e).index,o=t.oxw(2);return t.KtG(o.delFile(i))}),t._uU(2),t.TgZ(3,"mat-icon",19),t._uU(4,"delete"),t.qZA()()()}if(2&n){const e=h.$implicit;t.xp6(2),t.hij(" ",e.name," ")}}function ve(n,h){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,fe,5,1,"div",26),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.sharedvar.selPollResult.fileList)}}const ge=[{path:"",component:(()=>{class n{constructor(e,s,l,i,o,a,r,m,v,g,x){this.dtb=e,this.snkBar=s,this.dg=l,this.ds=i,this.nvg=o,this.sharedvar=a,this.notifServ=r,this.htm2pdf=m,this.voiceService=v,this.staffServ=g,this.chats=x,this.lchat=!1,this.goto=[],this.visitePollList=[],this.reset=0,this.commands="",this.loaded=!1,this.voiceService.init()}ngOnInit(){var e=this;return(0,c.Z)(function*(){e.sharedvar.pollExecSelected.pollList.length>0?(e.selectedPoll=e.sharedvar.pollExecSelected.pollList[0],e.goto.push(e.selectedPoll.id),e.availablePolls(e.selectedPoll.title,e.selectedPoll.id)):(e.snkBar.open("Listado de actividades vac\xedo.","Ok",{duration:5e3}),e.nvg.onRouteBack()),e.sharedvar.selPollResult=yield(0,R.z)(e.dtb.getLocalPollResult(e.sharedvar.pollExecSelected.pollResult_id)),e.loaded=!0,e.sharedvar.selPollResult.status<2&&(yield e.OnStartPoll()),e.subscribeChatEvent(),e.sharedvar.pollExecSelected.done&&e.onEndPoll()})()}OnStartPoll(){var e=this;return(0,c.Z)(function*(){e.sharedvar.selPollResult.status=2,e.sharedvar.selPollResult.date_ini=1e4*Math.trunc(Number(Date.now())/1e4),e.sharedvar.pollExecSelected.onStart&&(e.sharedvar.pollExecSelected.onStart.sendMail2&&e.sharedvar.pollExecSelected.onStart.sendMail2.length>0&&e.dtb.notifMail(e.sharedvar.selPollResult,e.sharedvar.pollExecSelected.onStart.sendMail2,"","start"),e.sharedvar.pollExecSelected.onStart.geoLoc&&(e.sharedvar.selPollResult.geoLocStart=yield e.sharedvar.getLocalization())),e.updateDefaValues(e.sharedvar.pollExecSelected.defa_values,e.sharedvar.selPollResult),e.dtb.addUpdateLocalList(e.sharedvar.pollExecSelected,e.sharedvar.selPollResult),e.dtb.updatePartialAsync(e.sharedvar.selPollResult,"status",e.sharedvar.pollExecSelected.staff_admin_id)})()}updateDefaValues(e,s){if(!e)return;this.sharedvar.selPollResult.crm_costum_id=e.crm_costum_id||"",this.sharedvar.selPollResult.crm_costum_name=e.crm_costum_name||"",this.sharedvar.selPollResult.crm_costum_contactname=e.crm_costum_contact||"",this.sharedvar.selPollResult.crm_costum_contactmail=e.crm_costum_email||"";let l=0,i=this.getCtrlValByType(l,"costumer");for(;null!=i;)i.poll&&i.name&&(i.poll.values[i.name]=e.crm_costum_name||""),l++,i=this.getCtrlValByType(l,"costumer");Object.keys(e).forEach(o=>{if(null!==e[o]){const a=this.getCtrlValByName(o);a&&(this.sharedvar.pollExecSelected.pollList[a.pollIndex].values[o]=e[o]||"")}}),this.reset++}OnEndPoll(){var e=this;return(0,c.Z)(function*(){if(e.sharedvar.selPollResult.date_end=1e4*Math.trunc(Number(Date.now())/1e4),e.sharedvar.selPollResult.staff_picture="",e.sharedvar.pollExecSelected.onEnd&&(e.sharedvar.pollExecSelected.onEnd.geoLoc&&(e.sharedvar.selPollResult.geoLocEnd=yield e.sharedvar.getLocalization()),e.sharedvar.pollExecSelected.onEnd.sendCRMMail)){let s="";(!e.sharedvar.pollExecSelected.onEnd.sendMail2||0===e.sharedvar.pollExecSelected.onEnd.sendMail2.length)&&(s=";"),e.sharedvar.pollExecSelected.onEnd.sendMail2+=s+e.sharedvar.selPollResult.crm_costum_contactmail}})()}availablePolls(e,s){this.visitePollList.find(l=>l===`${e}:${s}`)||this.visitePollList.push(`${e}:${s}`)}getAvailPollTitle(e){return e.split(":")[0]||""}visiteByAvailTitle(e){const s=e.split(":")[1];if(this.goto[this.goto.length-1]===s)return;const l=this.sharedvar.pollExecSelected.pollList.find(i=>i.id===s);l&&(this.goto.push(s),this.selectedPoll=l,this.scrollToTop(),this.reset++)}subscribeChatEvent(){var s,e=this;this.chatSub=this.notifServ.dtb_notification().subscribe({next:(s=(0,c.Z)(function*(l){"chat"===l.mycollection&&l.field_id&&l.field_id===e.sharedvar.selPollResult._id&&e.getChatState()}),function(i){return s.apply(this,arguments)}),complete:()=>{console.log()}}),this.getChatState()}getChatState(){var e=this;return(0,c.Z)(function*(){const s=yield e.dtb.getChat(e.sharedvar.selPollResult._id);e.sharedvar.selPollResult.status_date=Date.now(),e.sharedvar.selPollResult.chats=s;const l=s.length-1;return l>=0&&"W"===s[l].type?(e.snkBar.open(`Mensaje: ${e.sharedvar.selPollResult.chats[l].msg}.`,"Ok",{duration:3e3}),e.lchat=!0):e.lchat=!1,l})()}ngOnDestroy(){this.subs&&this.subs.unsubscribe()}getClicked(e){switch(e.index){case 4:let s=document.getElementById("spanTrigger");s&&(s.style.display="",s.style.position="absolute",s.style.left=e.pageX+5+"px",s.style.top=e.pageY+5+"px",this.editControlTrigger.openMenu());break;case 5:let l=document.getElementById("file2Trigger");l&&(l.style.display="",l.style.position="absolute",l.style.left=e.pageX+5+"px",l.style.top=e.pageY+5+"px",this.file2Trigger.openMenu());break;case 6:this.updateResultParcial();break;case 7:this.commands="question_mark"===this.commands?"":"question_mark"}}chatExec(e){this.chats.chatExec(0===e?"Administrador":"IA "+this.selectedPoll.title,this.sharedvar.selPollResult.chats,this.adminChat,this)}adminChat(e,s,l){e.sharedvar.selPollResult.chats=s,e.dtb.updatePartialAsync(e.sharedvar.selPollResult,"chats",e.sharedvar.pollExecSelected.staff_admin_id)}onGetData(e){var s=this;return(0,c.Z)(function*(){const l=e._btnclick_,i=e._evidenceClick_,o=e._propName_;if(o&&s.selectedPoll.schema.controls){const a=s.selectedPoll.schema.controls.find(r=>r.name===o);if(a&&a.tags)if(!0===l)switch(a.tags.type){case"goto":s.getGoto(o,a,e);break;case"geolocation":e[o]=yield s.sharedvar.getLocalization(),a.sideBtn="done",s.reset++;break;case"picture":s.getPicture(e,a,o);break;case"draw":s.getDraw(e,a,o);break;case"appoint":s.getAppoint(e,o);break;case"costumer":case"costumer_edit":s.getCostumer(e,o,"costumer_edit"==a.tags.type);break;case"product":s.getProduct(e,o);break;case"duplicate":const r=s.findDupPollList(s.selectedPoll,o);a.avalue=r,e[o]=r,r&&s.getGoto(o,a,e);break;case"text":case"textarea":e[o]=s.voiceService.voiceRecogition(),s.reset++}else if(e._command_&&e._command_===s.commands&&a.tags.help)s.snkBar.open(a.tags.help,"Listo",{duration:1e4});else if(e._btnclick_2_||"duplicate"===a.tags.type||"goto"===a.tags.type)s.getGoto(o,a,e);else{switch(i){case"note":s.getNote(e,a,o);break;case"picture":s.getPicture(e,a,o,"evidence");break;case"draw":s.getDraw(e,a,o,"evidence");break;case"attach":break;case"info":s.getInfo(e,a,o)}console.log("evidenceClick")}}s.updateLocalList(e)})()}onGetValid(e){this.selectedPoll.values._valid_!==e&&this.updateLocalList({_valid_:e})}getGoto(e,s,l){const i=this.sharedvar.pollExecSelected.pollList.find(o=>o.id===s.avalue);if(i&&s.avalue&&s.avalue.length>0)this.goto.push(s.avalue),this.reset++,setTimeout(()=>{delete l._valid_,this.updateLocalList(l),this.selectedPoll=i,this.sharedvar.selPollResult.metaValues[e]=this.selectedPoll.title,this.availablePolls(this.selectedPoll.title,this.selectedPoll.id),this.scrollToTop(),this.reset++},100);else if(s.selectOptions){const o=s.selectOptions.findIndex(a=>a.key===s.avalue);o>=0&&s.selectOptions.splice(o,1)}}updateLocalList(e){!this.selectedPoll.values||!e||(e._btnEvent_="",e._propName_="",this.selectedPoll.values=this.dg.updatePropResult(this.selectedPoll.values,e),this.dtb.addUpdateLocalList(this.sharedvar.pollExecSelected,this.sharedvar.selPollResult))}onBack(){var e=this;this.selectedPoll.values&&!1===this.selectedPoll.values._valid_?this.snkBar.open("Hay campos sin llenar. \xbfSalir de todos modos?","Si",{duration:7e3}).onAction().subscribe((0,c.Z)(function*(){e.onBackProcess()})):this.onBackProcess()}onBackProcess(){if(this.goto.length>1){const e=this.sharedvar.pollExecSelected.pollList.find(s=>s.id===this.goto[this.goto.length-2]);e&&(this.selectedPoll=e,this.goto.splice(this.goto.length-1,1),this.scrollToTop())}}onDelete(){var e=this;this.snkBar.open("\xbfBorrar \xe9ste grupo?","Ok",{duration:3e3}).onAction().subscribe((0,c.Z)(function*(){if(e.goto.length>1){const s=e.sharedvar.pollExecSelected.pollList.find(i=>i.id===e.goto[e.goto.length-2]),l=e.sharedvar.pollExecSelected.pollList.findIndex(i=>i.id===e.goto[e.goto.length-1]);l>=0&&e.sharedvar.pollExecSelected.pollList.splice(l,1),s&&(e.selectedPoll=s,e.goto.splice(e.goto.length-1,1),e.scrollToTop())}}))}onEndPoll(){var e=this;return(0,c.Z)(function*(){const s=e.isValid();""===s?e.selectedPoll.allowEnd&&e.snkBar.open("Finalizar la encuesta?","Ok",{duration:5e3}).onAction().subscribe((0,c.Z)(function*(){e.sharedvar.selPollResult=e.onResultDone(e.sharedvar.selPollResult),e.sharedvar.selPollResult?(e.sharedvar.selPollResult.ended=!0,e.sharedvar.selPollResult.status=3,e.sharedvar.selPollResult.status_date=Date.now(),(yield function G(n){return Z.apply(this,arguments)}())?window.location.hostname.includes("tasky-danilo-prod.up.railway.app")||window.location.hostname.includes("localhost")?yield e.exportResultDataDevelop():yield e.exportResultData():(e.snkBar.open("No fue posible exportar la informaci\xf3n. Por favor sincronice cuando est\xe9 linea.","Ok",{duration:3e3}),e.sharedvar.pollExecSelected.done=!0,e.dtb.addUpdateLocalList(e.sharedvar.pollExecSelected,e.sharedvar.selPollResult)),e.nvg.onRouteBack()):e.snkBar.open("Existen campos sin llenar.","Ok",{duration:3e3})})):e.snkBar.open(`Debe llenar campos requeridos en "${s}".`,"Ok",{duration:3e3})})()}isValid(){let e="",s=!0,l=[];for(const i of this.visitePollList){l=i.split(":");const o=this.sharedvar.pollExecSelected.pollList.find(a=>a.id===l[1]);if(o&&(s=o.values._valid_&&s,!s)){e=o.title;break}}return""!==e&&this.visiteByAvailTitle(l.join(":")),e}updateResultParcial(){var e=this;return(0,c.Z)(function*(){const s=JSON.parse(JSON.stringify(e.sharedvar.pollExecSelected)),l=JSON.parse(JSON.stringify(e.sharedvar.selPollResult));e.dtb.promiseMetaData(s,l,e.sharedvar.selPollResult.fileList).then(function(){var i=(0,c.Z)(function*(o){l.date_end=1e4*Math.trunc(Number(Date.now())/1e4),l.values={},l.values_type={},s.pollList.forEach(a=>{e.updatePollPropResult(l.values,l.values_type,a,l.evidenceValues)}),yield e.dtb.CreateUpdatePollResult(l),e.snkBar.open("Encuesta parcial enviada.","Listo",{duration:5e3})});return function(o){return i.apply(this,arguments)}}())})()}exportResultData(e=0,s=0){var l=this;return(0,c.Z)(function*(){l.dtb.promiseMetaData(l.sharedvar.pollExecSelected,l.sharedvar.selPollResult,l.sharedvar.selPollResult.fileList).then(function(){var i=(0,c.Z)(function*(o){o&&(console.log(l.sharedvar.selPollResult),l.sharedvar.selPollResult.values={},l.sharedvar.selPollResult.values_type={},l.sharedvar.selPollResult.fileList=[],l.sharedvar.pollExecSelected.pollList.forEach(a=>{l.updatePollPropResult(l.sharedvar.selPollResult.values,l.sharedvar.selPollResult.values_type,a,l.sharedvar.selPollResult.evidenceValues)}),yield l.OnEndPoll(),l.sharedvar.selPollResult.metaValues=[],l.sharedvar.selPollResult.evidenceValues={},e>0&&s>0&&(l.sharedvar.selPollResult.date_ini=e,l.sharedvar.selPollResult.date_end=s),console.log(l.sharedvar.selPollResult),l.sharedvar.selPollResult=yield l.dtb.CreateUpdatePollResult(l.sharedvar.selPollResult),yield l.dtb.updateStaffAsync(l.sharedvar.staff),l.htm2pdf.buildHtml2Pdf(l.sharedvar.selPollResult._id,l.sharedvar.pollExecSelected.onEnd?.sendMail2||""),l.dtb.delFromLocalList(l.sharedvar.pollExecSelected.id,l.sharedvar.pollExecSelected.pollResult_id),l.dtb.endStaffAppoint(),l.snkBar.open('Encuesta finalizada. Siga el reporte de sus encuestas en "Estado de mi Cuenta".',"Ok",{duration:5e3}))});return function(o){return i.apply(this,arguments)}}())})()}exportResultDataDevelop(){var e=this;return(0,c.Z)(function*(){const s=e.sharedvar.dateNow(),l=s+e.sharedvar.addMinutes(30);e.dg.aDefault({title:"Horario acomodado",schema:{controls:[{name:"date_ini",label:"Fecha y hora:",type:"datetime-local",validators:{required:!0}},{name:"date_end",label:"Fecha y hora:",type:"datetime-local",validators:{required:!0}}]},value:{date_ini:s,date_end:l},dgwidth:400,dgheigth:360}).subscribe(a=>{a&&e.exportResultData(a.date_ini,a.date_end)})})()}updatePollPropResult(e,s,l,i){return l.schema.controls?.forEach(o=>{if(l.values._btnEvent_="",l.values._propName_="",l.values._valid_="",l.values._btnclick_="",o.tags&&!0===o.tags.dtbase&&l.values[o.name]&&l.values[o.name].toString().length>0){let r=o.tags.type;switch(o.tags.type){case"draw":r="picture";break;case"product":case"multiselect":r="array";break;case"textarea":case"costumer":case"duplicate":case"goto":case"header":r="text"}e[o.name]=l.values[o.name],s[o.name]={type:r,label:o.label,evidence:!1}}let a=i[`${o.name}[D]`];a&&(e[`${o.name}[D]`]=a,s[`${o.name}[D]`]={type:"picture",label:`${o.label} Evid. Firma`,evidence:!0}),a=i[`${o.name}[P]`],a&&(e[`${o.name}[P]`]=a,s[`${o.name}[P]`]={type:"picture",label:`${o.label} Evid. Foto`,evidence:!0}),a=i[`${o.name}[N]`],a&&(e[`${o.name}[N]`]=a,s[`${o.name}[N]`]={type:"text",label:`${o.label} Evid. Notas`,evidence:!0}),a=i[`${o.name}[A]`],a&&(e[`${o.name}[A]`]=a,s[`${o.name}[A]`]={type:"any",label:`${o.label} Ev. Adjunto`,evidence:!0})}),e}getPicture(e,s,l,i="meta"){let o="";o="meta"===i?this.sharedvar.selPollResult.metaValues[l]?this.sharedvar.selPollResult.metaValues[l]:s.avalue:this.sharedvar.selPollResult.evidenceValues[`${l}[P]`]?this.sharedvar.selPollResult.evidenceValues[`${l}[P]`]:s.avalue,this.dg.aCamera({title:"C\xe1mara",value:{img:e,name:"pepito"}}).subscribe(r=>{r&&r.urlrute&&r.urlrute.length>0&&("meta"===i?(e[l]=`${s.label} \u2714\ufe0f`,this.sharedvar.selPollResult.metaValues[l]=r.urlrute):this.sharedvar.selPollResult.evidenceValues[`${l}[P]`]=r.urlrute,this.updateLocalList(e),this.reset++)})}getDraw(e,s,l,i="meta"){let o="";o="meta"===i?this.sharedvar.selPollResult.metaValues[l]?this.sharedvar.selPollResult.metaValues[l]:s.avalue:this.sharedvar.selPollResult.evidenceValues[`${l}[D]`]?this.sharedvar.selPollResult.evidenceValues[`${l}[D]`]:s.avalue,this.dg.aDraw({title:"Dibujar",value:{img:o,name:"pepito"}}).subscribe(r=>{r&&r.urlrute&&r.urlrute.length>0&&("meta"===i?(e[l]=`${s.label} \u2714\ufe0f`,this.sharedvar.selPollResult.metaValues[l]=r.urlrute):this.sharedvar.selPollResult.evidenceValues[`${l}[D]`]=r.urlrute,this.updateLocalList(e),this.reset++)})}getInfo(e,s,l){this.snkBar.open(`${s.label} --\x3e ${s.tags.help||""}`,"Ok",{duration:15e3})}getNote(e,s,l){this.dg.aDefault({title:"Observaciones",schema:{controls:[{name:"note",label:"Observaciones",type:"textarea",style:"w-full",totalRows:4,sideBtn:"mic_none",validators:{}}]},function:[{name:"note",self:this,btn_source:1,function:this.notemic}],value:{note:this.sharedvar.selPollResult.evidenceValues&&this.sharedvar.selPollResult.evidenceValues[`${l}[N]`]?this.sharedvar.selPollResult.evidenceValues[`${l}[N]`]:""},dgwidth:400,dgheigth:320}).subscribe(r=>{r&&(this.sharedvar.selPollResult.evidenceValues[`${l}[N]`]=r.note)})}notemic(e,s,l){return(0,c.Z)(function*(){if(s)return s.note=e.voiceService.voiceRecogition(),{schema:null,value:s}})()}getAppoint(e,s,l="appoint"){var i=this;return(0,c.Z)(function*(){const o=yield i.staffServ.onAddEditAppoint(i.sharedvar.selPollResult.metaValues[s]||null);if(o){const a=`${i.sharedvar.formatNumber2DateTime(o.datetime,"/")} - ${o.notes||""}`;e[s]=a,i.sharedvar.selPollResult.metaValues[s]=o,i.updateLocalList(e),i.reset++}})()}getCostumer(e,s,l){const i=this.sharedvar.pollExecSelected.costumerList;i&&i.length>0&&this.onSelCtrlList(i,"Seleccione Cliente",e,s,"costumer",!1,l)}getProduct(e,s){const l=this.sharedvar.pollExecSelected.productList;l&&l.length>0&&this.onSelCtrlList(l,"Seleccione Producto",e,s,"product",!0,!1)}onSelCtrlList(e,s,l,i,o,a,r){var m=this;return(0,c.Z)(function*(){const v=[];e.forEach(x=>{if(x){const b=x.split(":"),y=m.sharedvar.selPollResult.crm_prod_id?.findIndex(ye=>ye===b[0]);v.push({selected:!!(y&&y>=0),myid:b[0],name:b[1]})}});const g={title:s,viewfilter:!0,viewAdd:r,multiSelect:a,valuelst:v};return yield m.ds.aSelectDefault(g).subscribe(function(){var x=(0,c.Z)(function*(b){if(b)if("product"===o)m.sharedvar.selPollResult.crm_prod_id=[],l[i]="",b.forEach(y=>{l[i]+=y.name+",\n"}),m.updateLocalList(l),m.reset++;else{let y="";if(!0===b.new){const _=yield m.staffServ.newCostumer(m.staffServ);if(!_)return;m.sharedvar.selPollResult.crm_costum_id=_.id,m.sharedvar.selPollResult.crm_costum_name=_.name,m.sharedvar.selPollResult.crm_costum_contactmail=_.email_1,l[i]=_.name,y=`${_.id}:${_.name}:${_._id}:${_.linkup_1}:${_.phone_1}:${_.email_1}`,m.sharedvar.pollExecSelected.costumerList?.push(y)}else m.sharedvar.selPollResult.crm_costum_id=b[0].myid,m.sharedvar.selPollResult.crm_costum_name=b[0].name,m.sharedvar.selPollResult.crm_costum_contactmail=b[0].hide4,l[i]=b[0].name;m.updateLocalList(l),m.reset++}});return function(b){return x.apply(this,arguments)}}())})()}onResultDone(e){let s={...e};return this.sharedvar.pollExecSelected.pollList.forEach(l=>{s.values={...s.values,...l.values}}),s.values&&(s.values._btnEvent_="",s.values._valid_=!0),s}findDupPollList(e,s){const l=e.schema.controls?.find(a=>a.name==s);if(!l)return;const i=l.tags||{},o=this.sharedvar.pollExecSelected.pollList.find(a=>a.id===i.dupactivity);if(o){const a=JSON.parse(JSON.stringify(o));return a.title=`${o.title} ${o.dupTotal}`,o.dupTotal++,a.totalDup=0,a.id=this.dtb.getSerialKey(3,4,"_"),a.duplicated=!0,this.updatePollNames(a),l.selectOptions?.push({key:a.id,value:a.title}),this.sharedvar.pollExecSelected.pollList.push(a),this.dtb.addUpdateLocalList(this.sharedvar.pollExecSelected,this.sharedvar.selPollResult),this.reset++,a.id}}updatePollNames(e){e.schema.controls?.forEach(s=>{s.name=this.getUniqueName(e.title,s.name,this.sharedvar.pollExecSelected.pollList)})}getUniqueName(e,s,l){let i=0,o="";e.length>0&&(e=e.replace(" ","_")+"_"),s=`${e}${s.replace(" ","_")}`;for(let a=0;a<l.length;a++){const r=l[a].schema.controls||[];for(let m=0;m<r.length;m++)if(r[m].name.toUpperCase()===`${s}${o}`.toUpperCase()){o="_"+i++,a=-1;break}}return`${s}${o}`}getCtrlValByType(e,s){let l=0;for(let i=0;i<this.sharedvar.pollExecSelected.pollList.length;i++){const o=this.sharedvar.pollExecSelected.pollList[i];if(o.schema.controls){const a=o.schema.controls.find(r=>r.tags&&r.tags.type===s);if(a&&e===l)return{poll:o,name:a.name};l++}}return null}getCtrlValByName(e){for(let s=0;s<this.sharedvar.pollExecSelected.pollList.length;s++){const l=this.sharedvar.pollExecSelected.pollList[s];if(l.schema.controls){const i=l.schema.controls.find(o=>o.name.includes(e));if(null!=i)return{pollIndex:s,type:i.tags?["type"]:"unknown"}}}return null}onFile2(){this.file2.nativeElement.click()}delFile(e){this.sharedvar.selPollResult.fileList.splice(e,1),this.dtb.addUpdateLocalList(this.sharedvar.pollExecSelected,this.sharedvar.selPollResult)}onAddFile2Upload(e){this.sharedvar.selPollResult.fileList||(this.sharedvar.selPollResult.fileList=[]),this.sharedvar.selPollResult.fileList.push(e.target.files[0]),this.dtb.addUpdateLocalList(this.sharedvar.pollExecSelected,this.sharedvar.selPollResult)}scrollToTop(){this.maincontent.nativeElement.scrollTop=0}static#e=this.\u0275fac=function(s){return new(s||n)(t.Y36(N.k),t.Y36(A.ux),t.Y36(O.x),t.Y36(J),t.Y36(X.$),t.Y36(U.D),t.Y36(ee.$),t.Y36(te.Q),t.Y36(le),t.Y36(se),t.Y36(oe.a))};static#t=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-poll"]],viewQuery:function(s,l){if(1&s&&(t.Gf(ne,5),t.Gf(re,5),t.Gf(ce,5),t.Gf(de,5)),2&s){let i;t.iGM(i=t.CRH())&&(l.editControlTrigger=i.first),t.iGM(i=t.CRH())&&(l.file2Trigger=i.first),t.iGM(i=t.CRH())&&(l.file2=i.first),t.iGM(i=t.CRH())&&(l.maincontent=i.first)}},decls:43,vars:17,consts:[[1,"flex","flex-col","max-h-screen"],[3,"buttons","lchat","onClicked"],["id","spanTrigger",3,"matMenuTriggerFor"],["editControlTrigger","matMenuTrigger"],["id","file2Trigger",3,"matMenuTriggerFor"],["file2Trigger","matMenuTrigger"],[1,"flex","align-middle","justify-center","h-8","border-b","border-violet-500","font-medium","text-lg","p-1","mb-1","text-violet-900"],[1,"overflow-hidden",3,"matMenuTriggerFor"],[3,"matMenuTriggerFor"],[1,"grow","pt-3","mx-1","overflow-y-auto","overflow-x-hidden"],["maincontent",""],[3,"reset","jsonFormData","values","commands","result","valid"],[1,"h-12","flex","flex-row","items-center","justify-center","border-t","border-violet-500"],["color","primary","mat-raised-button","",3,"click",4,"ngIf"],["color","warn","mat-raised-button","",3,"click",4,"ngIf"],["visitedmenu","matMenu"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["chatmenu","matMenu"],["mat-menu-item","",3,"click"],["color","primary"],["file2menu","matMenu"],[4,"ngIf"],["type","file",1,"invisible",3,"change"],["file2",""],["color","primary","mat-raised-button","",3,"click"],["color","warn","mat-raised-button","",3,"click"],["mat-menu-item","",4,"ngFor","ngForOf"],["mat-menu-item",""]],template:function(s,l){if(1&s&&(t.TgZ(0,"div",0)(1,"app-header",1),t.NdJ("onClicked",function(o){return l.getClicked(o)}),t.qZA(),t._UZ(2,"span",2,3)(4,"span",4,5),t.TgZ(6,"div",6)(7,"span",7),t._uU(8),t.qZA(),t.TgZ(9,"mat-icon",8),t._uU(10,"arrow_drop_down"),t.qZA()(),t.TgZ(11,"div",9,10)(13,"app-dynamic-form",11),t.NdJ("result",function(o){return l.onGetData(o)})("valid",function(o){return l.onGetValid(o)}),t.qZA()(),t.TgZ(14,"div",12),t.YNc(15,ue,3,0,"button",13),t._uU(16," \xa0 "),t.YNc(17,he,4,0,"button",13),t._uU(18," \xa0 "),t.YNc(19,me,3,0,"button",14),t.qZA()(),t.TgZ(20,"mat-menu",null,15),t.YNc(22,pe,2,1,"button",16),t.qZA(),t.TgZ(23,"mat-menu",null,17)(25,"button",18),t.NdJ("click",function(){return l.chatExec(0)}),t.TgZ(26,"mat-icon",19),t._uU(27,"forum"),t.qZA(),t._uU(28," Administrador "),t.qZA(),t.TgZ(29,"button",18),t.NdJ("click",function(){return l.chatExec(1)}),t.TgZ(30,"mat-icon",19),t._uU(31,"auto_awesome"),t.qZA(),t._uU(32),t.qZA()(),t.TgZ(33,"mat-menu",null,20),t.YNc(35,ve,2,1,"div",21),t._UZ(36,"hr"),t.TgZ(37,"button",18),t.NdJ("click",function(){return l.onFile2()}),t._uU(38," Agregar archivo "),t.TgZ(39,"mat-icon",19),t._uU(40,"add"),t.qZA()()(),t.TgZ(41,"input",22,23),t.NdJ("change",function(o){return l.onAddFile2Upload(o)}),t.qZA()),2&s){const i=t.MAs(21),o=t.MAs(24),a=t.MAs(34);t.xp6(1),t.Q6J("buttons","00001101")("lchat",l.lchat),t.xp6(1),t.Q6J("matMenuTriggerFor",o),t.xp6(2),t.Q6J("matMenuTriggerFor",a),t.xp6(3),t.Q6J("matMenuTriggerFor",i),t.xp6(1),t.Oqu(l.selectedPoll.title),t.xp6(1),t.Q6J("matMenuTriggerFor",i),t.xp6(4),t.Q6J("reset",l.reset)("jsonFormData",l.selectedPoll.schema)("values",l.selectedPoll.values)("commands",l.commands),t.xp6(2),t.Q6J("ngIf",l.goto.length>1),t.xp6(2),t.Q6J("ngIf",l.selectedPoll.allowEnd),t.xp6(2),t.Q6J("ngIf",l.selectedPoll.duplicated),t.xp6(3),t.Q6J("ngForOf",l.visitePollList),t.xp6(10),t.hij(" AI ",l.selectedPoll.title," "),t.xp6(3),t.Q6J("ngIf",l.loaded)}},dependencies:[f.sg,f.O5,ie.G,ae.r,P.VK,P.OP,P.p6,D.lW,M.Hw]})}return n})()}];let _e=(()=>{class n{static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275mod=t.oAB({type:n});static#l=this.\u0275inj=t.cJS({imports:[u.Bz.forChild(ge),u.Bz]})}return n})();var xe=d(1569),be=d(9909);let Pe=(()=>{class n{static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275mod=t.oAB({type:n});static#l=this.\u0275inj=t.cJS({imports:[f.ez,_e,xe.O,be.N,P.Tx,D.ot,M.Ps,A.ZX]})}return n})()},807:k=>{const C="[a-fA-F\\d:]",d=p=>p&&p.includeBoundaries?`(?:(?<=\\s|^)(?=${C})|(?<=${C})(?=\\s|$))`:"",f="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",u="[a-fA-F\\d]{1,4}",c=`\n(?:\n(?:${u}:){7}(?:${u}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:${u}:){6}(?:${f}|:${u}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:${u}:){5}(?::${f}|(?::${u}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:${u}:){4}(?:(?::${u}){0,1}:${f}|(?::${u}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:${u}:){3}(?:(?::${u}){0,2}:${f}|(?::${u}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:${u}:){2}(?:(?::${u}){0,3}:${f}|(?::${u}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:${u}:){1}(?:(?::${u}){0,4}:${f}|(?::${u}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::(?:(?::${u}){0,5}:${f}|(?::${u}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1\n`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),R=new RegExp(`(?:^${f}$)|(?:^${c}$)`),w=new RegExp(`^${f}$`),E=new RegExp(`^${c}$`),T=p=>p&&p.exact?R:new RegExp(`(?:${d(p)}${f}${d(p)})|(?:${d(p)}${c}${d(p)})`,"g");T.v4=p=>p&&p.exact?w:new RegExp(`${d(p)}${f}${d(p)}`,"g"),T.v6=p=>p&&p.exact?E:new RegExp(`${d(p)}${c}${d(p)}`,"g"),k.exports=T},8403:(k,C,d)=>{const f=d(807),u=c=>f({exact:!0}).test(c);u.v4=c=>f.v4({exact:!0}).test(c),u.v6=c=>f.v6({exact:!0}).test(c),u.version=c=>u(c)?u.v4(c)?4:6:void 0,k.exports=u}}]);